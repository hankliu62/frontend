{"pageProps":{"article":{"url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/535","repository_url":"https://api.github.com/repos/hankliu62/hankliu62.github.com","labels_url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/535/labels{/name}","comments_url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/535/comments","events_url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/535/events","html_url":"https://github.com/hankliu62/hankliu62.github.com/issues/535","id":2126523614,"node_id":"I_kwDOBiJZIc5-wCze","number":535,"title":"讲一下EventEmitter？","user":{"login":"hankliu62","id":8088864,"node_id":"MDQ6VXNlcjgwODg4NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8088864?v=4","gravatar_id":"","url":"https://api.github.com/users/hankliu62","html_url":"https://github.com/hankliu62","followers_url":"https://api.github.com/users/hankliu62/followers","following_url":"https://api.github.com/users/hankliu62/following{/other_user}","gists_url":"https://api.github.com/users/hankliu62/gists{/gist_id}","starred_url":"https://api.github.com/users/hankliu62/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hankliu62/subscriptions","organizations_url":"https://api.github.com/users/hankliu62/orgs","repos_url":"https://api.github.com/users/hankliu62/repos","events_url":"https://api.github.com/users/hankliu62/events{/privacy}","received_events_url":"https://api.github.com/users/hankliu62/received_events","type":"User","site_admin":false},"labels":[{"id":6527252877,"node_id":"LA_kwDOBiJZIc8AAAABhQ35jQ","url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/labels/interview%20questions","name":"interview questions","color":"722ed1","default":false,"description":"面试题"},{"id":6536133677,"node_id":"LA_kwDOBiJZIc8AAAABhZV8LQ","url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/labels/node","name":"node","color":"66AA10","default":false,"description":"分类-Nodejs相关"}],"state":"open","locked":false,"assignee":{"login":"hankliu62","id":8088864,"node_id":"MDQ6VXNlcjgwODg4NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8088864?v=4","gravatar_id":"","url":"https://api.github.com/users/hankliu62","html_url":"https://github.com/hankliu62","followers_url":"https://api.github.com/users/hankliu62/followers","following_url":"https://api.github.com/users/hankliu62/following{/other_user}","gists_url":"https://api.github.com/users/hankliu62/gists{/gist_id}","starred_url":"https://api.github.com/users/hankliu62/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hankliu62/subscriptions","organizations_url":"https://api.github.com/users/hankliu62/orgs","repos_url":"https://api.github.com/users/hankliu62/repos","events_url":"https://api.github.com/users/hankliu62/events{/privacy}","received_events_url":"https://api.github.com/users/hankliu62/received_events","type":"User","site_admin":false},"assignees":[{"login":"hankliu62","id":8088864,"node_id":"MDQ6VXNlcjgwODg4NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8088864?v=4","gravatar_id":"","url":"https://api.github.com/users/hankliu62","html_url":"https://github.com/hankliu62","followers_url":"https://api.github.com/users/hankliu62/followers","following_url":"https://api.github.com/users/hankliu62/following{/other_user}","gists_url":"https://api.github.com/users/hankliu62/gists{/gist_id}","starred_url":"https://api.github.com/users/hankliu62/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hankliu62/subscriptions","organizations_url":"https://api.github.com/users/hankliu62/orgs","repos_url":"https://api.github.com/users/hankliu62/repos","events_url":"https://api.github.com/users/hankliu62/events{/privacy}","received_events_url":"https://api.github.com/users/hankliu62/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2024-02-09T05:55:05Z","updated_at":"2024-02-09T05:55:05Z","closed_at":null,"author_association":"OWNER","active_lock_reason":null,"body":"EventEmitter经常在面试的时候会要求手写，因为这玩意用途实在是太广了。比如在Vue里面的EventBus实现组件通信，其核心就是EventEmitter。\r\n\r\nNode.js 的大多数核心模块都是基于EventEmitter开发的，如 http、net、fs，很多第三方库也是基于EventEmitter开发的，如socket.io、nodemailercheerio等。\r\n\r\n使用EventEmitter的好处是可以用事件的形式来处理异步任务，可以大大简化代码，并且容易处理异常。\r\n\r\n举个例子来看看为什么Nodejs里大多数模块都要继承EventEmitter。\r\n\r\n这是不使用EventEmitter的on方法来实现文件读取：\r\n\r\n``` javascript\r\nconst fs = require('fs');\r\n\r\nfs.readFile('file.txt', (err, data) => {\r\n  if (err) {\r\n    console.error(`Failed to read file: ${err}`);\r\n  } else {\r\n    console.log(`File content: ${data}`);\r\n  }\r\n});\r\n```\r\n\r\n这是使用EventEmitter的读取文件：\r\n\r\n``` javascript\r\nconst fs = require('fs');\r\n\r\nconst stream = fs.createReadStream('file.txt');\r\n\r\nstream.on('data', (chunk) => {\r\n  console.log(`Received ${chunk.length} bytes of data.`);\r\n});\r\n\r\nstream.on('end', () => {\r\n  console.log('Finished reading file.');\r\n});\r\n```\r\n\r\n很显然，如果我们不使用EventEmitter，如果在读取完成后执行多个回调函数，就需要手动创建回调函数数组，并将每个回调函数都添加到数组中，这样代码就会变得复杂。","closed_by":null,"reactions":{"url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/535/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/535/timeline","performed_via_github_app":null,"state_reason":null},"menus":[]},"__N_SSG":true}