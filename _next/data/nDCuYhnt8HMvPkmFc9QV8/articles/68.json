{"pageProps":{"article":{"url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/68","repository_url":"https://api.github.com/repos/hankliu62/hankliu62.github.com","labels_url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/68/labels{/name}","comments_url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/68/comments","events_url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/68/events","html_url":"https://github.com/hankliu62/hankliu62.github.com/issues/68","id":1647024863,"node_id":"I_kwDOBiJZIc5iK5rf","number":68,"title":"检测系统主题动态设置样式","user":{"login":"hankliu62","id":8088864,"node_id":"MDQ6VXNlcjgwODg4NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8088864?v=4","gravatar_id":"","url":"https://api.github.com/users/hankliu62","html_url":"https://github.com/hankliu62","followers_url":"https://api.github.com/users/hankliu62/followers","following_url":"https://api.github.com/users/hankliu62/following{/other_user}","gists_url":"https://api.github.com/users/hankliu62/gists{/gist_id}","starred_url":"https://api.github.com/users/hankliu62/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hankliu62/subscriptions","organizations_url":"https://api.github.com/users/hankliu62/orgs","repos_url":"https://api.github.com/users/hankliu62/repos","events_url":"https://api.github.com/users/hankliu62/events{/privacy}","received_events_url":"https://api.github.com/users/hankliu62/received_events","type":"User","site_admin":false},"labels":[{"id":688950687,"node_id":"MDU6TGFiZWw2ODg5NTA2ODc=","url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/labels/blog","name":"blog","color":"1677ff","default":false,"description":"博客文章"}],"state":"open","locked":false,"assignee":{"login":"hankliu62","id":8088864,"node_id":"MDQ6VXNlcjgwODg4NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8088864?v=4","gravatar_id":"","url":"https://api.github.com/users/hankliu62","html_url":"https://github.com/hankliu62","followers_url":"https://api.github.com/users/hankliu62/followers","following_url":"https://api.github.com/users/hankliu62/following{/other_user}","gists_url":"https://api.github.com/users/hankliu62/gists{/gist_id}","starred_url":"https://api.github.com/users/hankliu62/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hankliu62/subscriptions","organizations_url":"https://api.github.com/users/hankliu62/orgs","repos_url":"https://api.github.com/users/hankliu62/repos","events_url":"https://api.github.com/users/hankliu62/events{/privacy}","received_events_url":"https://api.github.com/users/hankliu62/received_events","type":"User","site_admin":false},"assignees":[{"login":"hankliu62","id":8088864,"node_id":"MDQ6VXNlcjgwODg4NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8088864?v=4","gravatar_id":"","url":"https://api.github.com/users/hankliu62","html_url":"https://github.com/hankliu62","followers_url":"https://api.github.com/users/hankliu62/followers","following_url":"https://api.github.com/users/hankliu62/following{/other_user}","gists_url":"https://api.github.com/users/hankliu62/gists{/gist_id}","starred_url":"https://api.github.com/users/hankliu62/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hankliu62/subscriptions","organizations_url":"https://api.github.com/users/hankliu62/orgs","repos_url":"https://api.github.com/users/hankliu62/repos","events_url":"https://api.github.com/users/hankliu62/events{/privacy}","received_events_url":"https://api.github.com/users/hankliu62/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2023-03-30T06:55:18Z","updated_at":"2023-03-30T06:55:18Z","closed_at":null,"author_association":"OWNER","active_lock_reason":null,"body":"> 近来来根据系统主题确定网页主题的场景越来越多了，国内常用的方式是基于CSS媒体查询的，CSS媒体查询不能根据用户喜好来自定义主题，所以本篇文章收纳了CSS和JS两种场景。\r\n\r\n### CSS利用媒体查询\r\n\r\n在CSS中可以使用利用媒体属性 preferred-color-scheme。\r\n\r\n``` css\r\n@media (prefers-color-scheme: light) {\r\n      body {\r\n        background: #fff;\r\n        color: #333;\r\n      }\r\n    }\r\n    @media (prefers-color-scheme: dark) {\r\n      body {\r\n        background: #333;\r\n        color: #fff;\r\n      }\r\n    }\r\n```\r\n\r\n### Javascript检测系统主题\r\n\r\n#### 获取系统主题\r\n\r\n获取JavaScript中的浅色或深色主题，使用matchMedia函数检查是否已满足CSS媒体查询。\r\n通过结果的matches判断当前主题是否正确\r\n\r\n``` js\r\nconst themeMedia = window.matchMedia(\"(prefers-color-scheme: light)\");\r\n    if (themeMedia.matches) {\r\n        console.log('light')\r\n    } else {\r\n        console.log('dark')\r\n    }\r\n```\r\n\r\n#### 监听主题变化\r\n\r\n上述方法仅能获取一次主题，若用户切换主题时，页面是无法实时更换主题的。\r\n幸运的是，上述的媒体查询结果(MediaQueryList)对象支持addListener方法监听主题变化。\r\n通过监听就可以解决主题切换实时更新的额问题了。\r\n\r\n``` js\r\nconst themeMedia = window.matchMedia(\"(prefers-color-scheme: light)\");\r\n    themeMedia.addListener(e => {\r\n        if (e.matches) {\r\n            console.log('light')\r\n        } else {\r\n            console.log('dark')\r\n        }\r\n    });\r\n```","closed_by":null,"reactions":{"url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/68/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/68/timeline","performed_via_github_app":null,"state_reason":null},"menus":["### CSS利用媒体查询","### Javascript检测系统主题","#### 获取系统主题","#### 监听主题变化"]},"__N_SSG":true}