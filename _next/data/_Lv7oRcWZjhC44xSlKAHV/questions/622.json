{"pageProps":{"issue":{"url":"https://api.github.com/repos/hankliu62/interview/issues/622","repository_url":"https://api.github.com/repos/hankliu62/interview","labels_url":"https://api.github.com/repos/hankliu62/interview/issues/622/labels{/name}","comments_url":"https://api.github.com/repos/hankliu62/interview/issues/622/comments","events_url":"https://api.github.com/repos/hankliu62/interview/issues/622/events","html_url":"https://github.com/hankliu62/interview/issues/622","id":2268281053,"node_id":"I_kwDOLNphd86HMzjd","number":622,"title":"Monorepoæ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ","user":{"login":"hankliu62","id":8088864,"node_id":"MDQ6VXNlcjgwODg4NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8088864?v=4","gravatar_id":"","url":"https://api.github.com/users/hankliu62","html_url":"https://github.com/hankliu62","followers_url":"https://api.github.com/users/hankliu62/followers","following_url":"https://api.github.com/users/hankliu62/following{/other_user}","gists_url":"https://api.github.com/users/hankliu62/gists{/gist_id}","starred_url":"https://api.github.com/users/hankliu62/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hankliu62/subscriptions","organizations_url":"https://api.github.com/users/hankliu62/orgs","repos_url":"https://api.github.com/users/hankliu62/repos","events_url":"https://api.github.com/users/hankliu62/events{/privacy}","received_events_url":"https://api.github.com/users/hankliu62/received_events","type":"User","site_admin":false},"labels":[{"id":6547468280,"node_id":"LA_kwDOLNphd88AAAABhkJv-A","url":"https://api.github.com/repos/hankliu62/interview/labels/project","name":"project","color":"2B80B3","default":false,"description":"é¡¹ç›®ç›¸å…³"}],"state":"open","locked":false,"assignee":{"login":"hankliu62","id":8088864,"node_id":"MDQ6VXNlcjgwODg4NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8088864?v=4","gravatar_id":"","url":"https://api.github.com/users/hankliu62","html_url":"https://github.com/hankliu62","followers_url":"https://api.github.com/users/hankliu62/followers","following_url":"https://api.github.com/users/hankliu62/following{/other_user}","gists_url":"https://api.github.com/users/hankliu62/gists{/gist_id}","starred_url":"https://api.github.com/users/hankliu62/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hankliu62/subscriptions","organizations_url":"https://api.github.com/users/hankliu62/orgs","repos_url":"https://api.github.com/users/hankliu62/repos","events_url":"https://api.github.com/users/hankliu62/events{/privacy}","received_events_url":"https://api.github.com/users/hankliu62/received_events","type":"User","site_admin":false},"assignees":[{"login":"hankliu62","id":8088864,"node_id":"MDQ6VXNlcjgwODg4NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8088864?v=4","gravatar_id":"","url":"https://api.github.com/users/hankliu62","html_url":"https://github.com/hankliu62","followers_url":"https://api.github.com/users/hankliu62/followers","following_url":"https://api.github.com/users/hankliu62/following{/other_user}","gists_url":"https://api.github.com/users/hankliu62/gists{/gist_id}","starred_url":"https://api.github.com/users/hankliu62/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hankliu62/subscriptions","organizations_url":"https://api.github.com/users/hankliu62/orgs","repos_url":"https://api.github.com/users/hankliu62/repos","events_url":"https://api.github.com/users/hankliu62/events{/privacy}","received_events_url":"https://api.github.com/users/hankliu62/received_events","type":"User","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/hankliu62/interview/milestones/3","html_url":"https://github.com/hankliu62/interview/milestone/3","labels_url":"https://api.github.com/repos/hankliu62/interview/milestones/3/labels","id":10707686,"node_id":"MI_kwDOLNphd84Ao2Lm","number":3,"title":"3","description":"æè¿°é—®é¢˜éš¾åº¦ï¼Œéš¾åº¦3ğŸŒŸ","creator":{"login":"hankliu62","id":8088864,"node_id":"MDQ6VXNlcjgwODg4NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8088864?v=4","gravatar_id":"","url":"https://api.github.com/users/hankliu62","html_url":"https://github.com/hankliu62","followers_url":"https://api.github.com/users/hankliu62/followers","following_url":"https://api.github.com/users/hankliu62/following{/other_user}","gists_url":"https://api.github.com/users/hankliu62/gists{/gist_id}","starred_url":"https://api.github.com/users/hankliu62/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hankliu62/subscriptions","organizations_url":"https://api.github.com/users/hankliu62/orgs","repos_url":"https://api.github.com/users/hankliu62/repos","events_url":"https://api.github.com/users/hankliu62/events{/privacy}","received_events_url":"https://api.github.com/users/hankliu62/received_events","type":"User","site_admin":false},"open_issues":16,"closed_issues":0,"state":"open","created_at":"2024-03-20T03:36:24Z","updated_at":"2024-05-03T08:08:15Z","due_on":null,"closed_at":null},"comments":0,"created_at":"2024-04-29T07:04:09Z","updated_at":"2024-04-29T07:05:25Z","closed_at":null,"author_association":"OWNER","active_lock_reason":null,"body":"Monorepo æ˜¯ä¸€ç§é¡¹ç›®ä»£ç ç®¡ç†æ–¹å¼ï¼ŒæŒ‡å•ä¸ªä»“åº“ä¸­ç®¡ç†å¤šä¸ªé¡¹ç›®ï¼Œæœ‰åŠ©äºç®€åŒ–ä»£ç å…±äº«ã€ä¾èµ–ç®¡ç†ã€ç‰ˆæœ¬æ§åˆ¶ã€æ„å»ºå’Œéƒ¨ç½²ç­‰æ–¹é¢çš„å¤æ‚æ€§ï¼Œå¹¶æä¾›æ›´å¥½çš„å¯é‡ç”¨æ€§å’Œåä½œæ€§ã€‚Monorepo æå€¡äº†å¼€æ”¾ã€é€æ˜ã€å…±äº«çš„ç»„ç»‡æ–‡åŒ–ï¼Œè¿™ç§æ–¹æ³•å·²ç»è¢«å¾ˆå¤šå¤§å‹å…¬å¸å¹¿æ³›ä½¿ç”¨ï¼Œå¦‚ Googleã€Facebook å’Œ Microsoft ç­‰ã€‚\r\n\r\n### ä¼˜åŠ¿\r\nMonorepo çš„ä¸»è¦ä¼˜åŠ¿åŒ…æ‹¬ï¼š\r\n\r\n- ä»£ç å…±äº«å’Œé‡ç”¨ï¼šæ‰€æœ‰é¡¹ç›®å…±äº«åŒä¸€ä¸ªä»£ç åº“ï¼Œè¿™å¯ä»¥å‡å°‘é‡å¤ä»£ç å¹¶æé«˜å¼€å‘æ•ˆç‡ã€‚\r\n- ä¾èµ–ç®¡ç†ç®€åŒ–ï¼šæ‰€æœ‰é¡¹ç›®éƒ½ä½¿ç”¨ç›¸åŒçš„ä¾èµ–é¡¹ï¼Œè¿™å¯ä»¥ç®€åŒ–ä¾èµ–ç®¡ç†å¹¶å‡å°‘å†²çªã€‚\r\n- æŒç»­é›†æˆå’ŒæŒç»­äº¤ä»˜ï¼šMonorepo å¯ä»¥ç®€åŒ–æŒç»­é›†æˆå’ŒæŒç»­äº¤ä»˜æµç¨‹ï¼Œå› ä¸ºæ‰€æœ‰é¡¹ç›®éƒ½å¯ä»¥åœ¨åŒä¸€ä¸ªç®¡é“ä¸­æ„å»ºå’Œæµ‹è¯•ã€‚\r\n- æ”¹è¿›çš„åä½œï¼šMonorepo å¯ä»¥æ”¹å–„å¼€å‘äººå‘˜ä¹‹é—´çš„åä½œï¼Œå› ä¸ºä»–ä»¬å¯ä»¥è½»æ¾åœ°è®¿é—®æ‰€æœ‰é¡¹ç›®çš„ä»£ç ã€‚\r\n\r\n### Monorepo æ–¹æ¡ˆ\r\n\r\n#### Turborepo\r\n[Turborepo](https://link.juejin.cn/?target=https%3A%2F%2Fturbo.build%2F) æ˜¯ Vercel å›¢é˜Ÿå¼€æºçš„é«˜æ€§èƒ½æ„å»ºä»£ç ä»“åº“ç³»ç»Ÿï¼Œå…è®¸å¼€å‘è€…ä½¿ç”¨ä¸åŒçš„æ„å»ºç³»ç»Ÿã€‚\r\n\r\næ„å»ºåŠ é€Ÿæ€è·¯ï¼š\r\n\r\n- Multiple Running Taskï¼šæ„å»ºä»»åŠ¡å¹¶è¡Œè¿›è¡Œï¼Œæ„å»ºé¡ºåºäº¤ç»™å¼€å‘è€…é…ç½®\r\n- Cacheã€Remote Cacheï¼šé€šè¿‡ç¼“å­˜ åŠ è¿œç¨‹ç¼“å­˜ï¼Œå‡å°‘æ„å»ºæ—¶é—´\r\n\r\nä¸¾ä¾‹ Multiple Running Taskï¼šæˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ª Monorepo çš„é¡¹ç›®ï¼Œæœ‰ä»¥ä¸‹å‡ ä¸ª packageï¼š\r\n\r\n- apps/webï¼Œä¾èµ– shared\r\n- apps/docsï¼Œä¾èµ– shared\r\n- package/sharedï¼Œè¢« web å’Œ docs ä¾èµ–\r\n\r\n``` bash\r\n# å½“æˆ‘ä»¬ä½¿ç”¨æ­£å¸¸çš„ yarn workspace å»ç®¡ç† monorepo çš„å·¥ä½œæµä»»åŠ¡æ—¶ï¼Œä¾‹å¦‚æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š\r\nyarn workspaces run lint\r\nyarn workspaces run test\r\nyarn workspaces run build\r\n```\r\n\r\n#### Nx\r\nNx æ˜¯ [Nrwl](https://link.juejin.cn/?target=https%3A%2F%2Fnx.app%2Fcompany) å›¢é˜Ÿå¼€å‘çš„ï¼ŒåŒæ—¶åœ¨ç»´æŠ¤ Lernaï¼Œç›®å‰ Nx å¯ä»¥ä¸ Learn 5.1åŠä»¥ä¸Šé›†æˆä½¿ç”¨\r\n\r\næ„å»ºåŠ é€Ÿæ€è·¯ï¼ˆæ¯” Turborepo æ›´ä¸°å¯Œï¼‰\r\n\r\n- ç¼“å­˜ï¼š é€šè¿‡ç¼“å­˜ åŠ è¿œç¨‹ç¼“å­˜ï¼Œå‡å°‘æ„å»ºæ—¶é—´ï¼ˆè¿œç¨‹ç¼“å­˜ï¼šNx å…¬å¼€äº†ä¸€ä¸ªå…¬å…± APIï¼Œå®ƒå…è®¸æ‚¨æä¾›è‡ªå·±çš„è¿œç¨‹ç¼“å­˜å®ç°ï¼ŒTurborepo å¿…é¡»ä½¿ç”¨å†…ç½®çš„è¿œç¨‹ç¼“å­˜ï¼‰\r\n- å¢é‡æ„å»ºï¼š æœ€å°èŒƒå›´æ„å»ºï¼Œéå…¨é‡æ„å»º\r\n- å¹¶è¡Œæ„å»ºï¼š Nx è‡ªåŠ¨åˆ†æé¡¹ç›®çš„å…³è”å…³ç³»ï¼Œå¯¹è¿™äº›ä»»åŠ¡è¿›è¡Œæ’åºä»¥æœ€å¤§åŒ–å¹¶è¡Œæ€§\r\n- åˆ†å¸ƒå¼æ„å»ºï¼š ç»“åˆ Nx Cloudï¼Œæ‚¨çš„ä»»åŠ¡å°†è‡ªåŠ¨åˆ†å¸ƒåœ¨ CI ä»£ç†ä¸­ï¼ˆå¤šå°è¿œç¨‹æ„å»ºæœºå™¨ï¼‰ï¼ŒåŒæ—¶è€ƒè™‘æ„å»ºé¡ºåºã€æœ€å¤§åŒ–å¹¶è¡ŒåŒ–å’Œä»£ç†åˆ©ç”¨ç‡\r\n- ç”¨ Nx å¼ºå¤§çš„ä»»åŠ¡è°ƒåº¦å™¨åŠ é€Ÿ Lernaï¼šLerna æ“…é•¿ç®¡ç†ä¾èµ–å…³ç³»å’Œå‘å¸ƒï¼Œä½†æ‰©å±•åŸºäº Lerna çš„ Monorepos å¾ˆå¿«å°±ä¼šå˜å¾—å¾ˆç—›è‹¦ï¼Œå› ä¸º Lerna å¾ˆæ…¢ã€‚è¿™å°±æ˜¯ Nx çš„é—ªå…‰ç‚¹ï¼Œä¹Ÿæ˜¯å®ƒå¯ä»¥çœŸæ­£åŠ é€Ÿä½ çš„ monorepo çš„åœ°æ–¹ã€‚\r\n\r\n#### Lerna\r\n\r\n**[Lerna](https://link.juejin.cn/?target=https%3A%2F%2Flerna.js.org%2F) æ˜¯ä»€ä¹ˆï¼Ÿ**\r\n\r\n- Lerna æ˜¯ Babel ä¸ºå®ç° Monorepo å¼€å‘çš„å·¥å…·ï¼›æœ€æ“…é•¿ç®¡ç†ä¾èµ–å…³ç³»å’Œå‘å¸ƒ\r\n- Lerna ä¼˜åŒ–äº†å¤šåŒ…å·¥ä½œæµï¼Œè§£å†³äº†å¤šåŒ…ä¾èµ–ã€å‘ç‰ˆæ‰‹åŠ¨ç»´æŠ¤ç‰ˆæœ¬ç­‰é—®é¢˜\r\n- Lerna ä¸æä¾›æ„å»ºã€æµ‹è¯•ç­‰ä»»åŠ¡ï¼Œå·¥ç¨‹èƒ½åŠ›è¾ƒå¼±ï¼Œé¡¹ç›®ä¸­å¾€å¾€éœ€è¦åŸºäºå®ƒè¿›è¡Œé¡¶å±‚èƒ½åŠ›çš„å°è£…\r\n\r\n**Lerna ä¸»è¦åšä¸‰ä»¶äº‹**\r\n\r\n1. ä¸ºå•ä¸ªåŒ…æˆ–å¤šä¸ªåŒ…è¿è¡Œå‘½ä»¤ (lerna run)\r\n2. ç®¡ç†ä¾èµ–é¡¹ (lerna bootstrap)\r\n3. å‘å¸ƒä¾èµ–åŒ…ï¼Œå¤„ç†ç‰ˆæœ¬ç®¡ç†ï¼Œå¹¶ç”Ÿæˆå˜æ›´æ—¥å¿— (lerna publish)\r\n\r\n**Lerna èƒ½è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ**\r\n\r\n1. ä»£ç å…±äº«ï¼Œè°ƒè¯•ä¾¿æ·ï¼š ä¸€ä¸ªä¾èµ–åŒ…æ›´æ–°ï¼Œå…¶ä»–ä¾èµ–æ­¤åŒ…çš„åŒ…/é¡¹ç›®æ— éœ€å®‰è£…æœ€æ–°ç‰ˆæœ¬ï¼Œå› ä¸º Lerna è‡ªåŠ¨ Link\r\n2. å®‰è£…ä¾èµ–ï¼Œå‡å°‘å†—ä½™ï¼šå¤šä¸ªåŒ…éƒ½ä½¿ç”¨ç›¸åŒç‰ˆæœ¬çš„ä¾èµ–åŒ…æ—¶ï¼ŒLerna ä¼˜å…ˆå°†ä¾èµ–åŒ…å®‰è£…åœ¨æ ¹ç›®å½•\r\n3. è§„èŒƒç‰ˆæœ¬ç®¡ç†ï¼š Lerna é€šè¿‡ Git æ£€æµ‹ä»£ç å˜åŠ¨ï¼Œè‡ªåŠ¨å‘ç‰ˆã€æ›´æ–°ç‰ˆæœ¬å·ï¼›ä¸¤ç§æ¨¡å¼ç®¡ç†å¤šä¸ªä¾èµ–åŒ…çš„ç‰ˆæœ¬å·\r\n4. è‡ªåŠ¨ç”Ÿæˆå‘ç‰ˆæ—¥å¿—ï¼šä½¿ç”¨æ’ä»¶ï¼Œæ ¹æ® Git Commit è®°å½•ï¼Œè‡ªåŠ¨ç”Ÿæˆ ChangeLog\r\n\r\n**Lerna è‡ªåŠ¨æ£€æµ‹å‘å¸ƒï¼Œåˆ¤æ–­é€»è¾‘**\r\n\r\n- æ ¡éªŒæœ¬åœ°æ˜¯å¦æœ‰æ²¡æœ‰è¢« commit å†…å®¹ï¼Ÿ\r\n- åˆ¤æ–­å½“å‰çš„åˆ†æ”¯æ˜¯å¦æ­£å¸¸ï¼Ÿ\r\n- åˆ¤æ–­å½“å‰åˆ†æ”¯æ˜¯å¦åœ¨ remote å­˜åœ¨ï¼Ÿ\r\n- åˆ¤æ–­å½“å‰åˆ†æ”¯æ˜¯å¦åœ¨ lerna.json å…è®¸çš„ allowBranch è®¾ç½®ä¹‹ä¸­ï¼Ÿ\r\n- åˆ¤æ–­å½“å‰åˆ†æ”¯æäº¤æ˜¯å¦è½åäº remote\r\n\r\n\r\n","closed_by":null,"reactions":{"url":"https://api.github.com/repos/hankliu62/interview/issues/622/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/hankliu62/interview/issues/622/timeline","performed_via_github_app":null,"state_reason":null},"menus":["### ä¼˜åŠ¿","### Monorepo æ–¹æ¡ˆ","#### Turborepo","#### Nx","#### Lerna"]},"__N_SSG":true}