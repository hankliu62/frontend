{"pageProps":{"article":{"url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/646","repository_url":"https://api.github.com/repos/hankliu62/hankliu62.github.com","labels_url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/646/labels{/name}","comments_url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/646/comments","events_url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/646/events","html_url":"https://github.com/hankliu62/hankliu62.github.com/issues/646","id":2218783309,"node_id":"I_kwDOBiJZIc6EP_JN","number":646,"title":"NextJs 获取 Github Action 部署的环境变量","user":{"login":"hankliu62","id":8088864,"node_id":"MDQ6VXNlcjgwODg4NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8088864?v=4","gravatar_id":"","url":"https://api.github.com/users/hankliu62","html_url":"https://github.com/hankliu62","followers_url":"https://api.github.com/users/hankliu62/followers","following_url":"https://api.github.com/users/hankliu62/following{/other_user}","gists_url":"https://api.github.com/users/hankliu62/gists{/gist_id}","starred_url":"https://api.github.com/users/hankliu62/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hankliu62/subscriptions","organizations_url":"https://api.github.com/users/hankliu62/orgs","repos_url":"https://api.github.com/users/hankliu62/repos","events_url":"https://api.github.com/users/hankliu62/events{/privacy}","received_events_url":"https://api.github.com/users/hankliu62/received_events","type":"User","site_admin":false},"labels":[{"id":688950687,"node_id":"MDU6TGFiZWw2ODg5NTA2ODc=","url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/labels/blog","name":"blog","color":"1677ff","default":false,"description":"博客文章"},{"id":6667206448,"node_id":"LA_kwDOBiJZIc8AAAABjWV_MA","url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/labels/git","name":"git","color":"2EEE75","default":false,"description":"分类-Git相关"}],"state":"open","locked":false,"assignee":{"login":"hankliu62","id":8088864,"node_id":"MDQ6VXNlcjgwODg4NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8088864?v=4","gravatar_id":"","url":"https://api.github.com/users/hankliu62","html_url":"https://github.com/hankliu62","followers_url":"https://api.github.com/users/hankliu62/followers","following_url":"https://api.github.com/users/hankliu62/following{/other_user}","gists_url":"https://api.github.com/users/hankliu62/gists{/gist_id}","starred_url":"https://api.github.com/users/hankliu62/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hankliu62/subscriptions","organizations_url":"https://api.github.com/users/hankliu62/orgs","repos_url":"https://api.github.com/users/hankliu62/repos","events_url":"https://api.github.com/users/hankliu62/events{/privacy}","received_events_url":"https://api.github.com/users/hankliu62/received_events","type":"User","site_admin":false},"assignees":[{"login":"hankliu62","id":8088864,"node_id":"MDQ6VXNlcjgwODg4NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8088864?v=4","gravatar_id":"","url":"https://api.github.com/users/hankliu62","html_url":"https://github.com/hankliu62","followers_url":"https://api.github.com/users/hankliu62/followers","following_url":"https://api.github.com/users/hankliu62/following{/other_user}","gists_url":"https://api.github.com/users/hankliu62/gists{/gist_id}","starred_url":"https://api.github.com/users/hankliu62/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hankliu62/subscriptions","organizations_url":"https://api.github.com/users/hankliu62/orgs","repos_url":"https://api.github.com/users/hankliu62/repos","events_url":"https://api.github.com/users/hankliu62/events{/privacy}","received_events_url":"https://api.github.com/users/hankliu62/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2024-04-01T18:07:15Z","updated_at":"2024-04-01T18:07:16Z","closed_at":null,"author_association":"OWNER","active_lock_reason":null,"body":"## NextJs 获取 Github Action 部署的环境变量\n\n### 设置变量\n\n项目中需要某些私有密钥，不能直接暴露在仓库中，在编译`Next.js`的时候，需要将该密钥通过环境变量的形式注入到`Next.js`项目中，所以第一步，我们需要将这个密钥储存到当前仓库的`Settings/Secrets`里面，具体操作如下图所示：\n\n![image](https://github.com/hankliu62/interview/assets/8088864/887a0ad5-6b4a-4977-a2cb-8c7adc5b63b6)\n\n### 配置变量\n\n在`Next.js`中获取`GitHub Actions`环境变量，你可以使用`process.env`对象来访问在`GitHub Actions`中设置的环境变量。以下是一个如何在`Next.js`中获取`GitHub Actions`环境变量的例子：\n\n首先，在GitHub Actions的工作流文件中设置环境变量，例如在 `.github/workflows/ci.yml`中：\n\n``` yml\njobs:\n  build:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Checkout code\n        uses: actions/checkout@v2\n      - name: Setup Node.js\n        uses: actions/setup-node@v2\n        with:\n          node-version: 14\n      - name: Install Dependencies\n        run: npm install\n      - name: Build Next.js App\n        env:\n          MY_ENV_VAR: ${{ secrets.MY_SECRET_ENV_VAR }}\n        run: npm run build\n```\n\n在这个例子中，`MY_ENV_VAR`是一个环境变量，它可以是一个秘密值，通过`GitHub Actions`的秘密（secrets）功能来安全地设置。\n\n然后，需要将环境变量添加到 `Next` 项目的配置文件中，在 `next.config.js` 中：\n\n``` js\nmodule.exports = {\n  env: {\n    MY_ENV_VAR: process.env.MY_ENV_VAR,\n  }\n}\n```\n\n### 获取变量\n\n然后，在Next.js的应用代码中，你可以这样获取这个环境变量：\n\n``` js\n// pages/index.js\nexport default function Home() {\n  const myEnvVar = process.env.MY_ENV_VAR;\n  return (\n    <div>\n      <p>The environment variable is: {myEnvVar || 'undefined'}</p>\n    </div>\n  );\n}\n```\n\n在这段代码中，`process.env.MY_ENV_VAR` 将会获取在 `GitHub Actions` 中设置的环境变量`MY_ENV_VAR`的值。如果环境变量存在，它将被显示在页面上；如果不存在，则会显示`'undefined'`。","closed_by":null,"reactions":{"url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/646/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/646/timeline","performed_via_github_app":null,"state_reason":null},"menus":["## NextJs 获取 Github Action 部署的环境变量\n\n### 设置变量\n\n项目中需要某些私有密钥，不能直接暴露在仓库中，在编译`Next.js`的时候，需要将该密钥通过环境变量的形式注入到`Next.js`项目中，所以第一步，我们需要将这个密钥储存到当前仓库的`Settings/Secrets`里面，具体操作如下图所示：\n\n![image](https://github.com/hankliu62/interview/assets/8088864/887a0ad5-6b4a-4977-a2cb-8c7adc5b63b6)\n\n### 配置变量\n\n在`Next.js`中获取`GitHub Actions`环境变量，你可以使用`process.env`对象来访问在`GitHub Actions`中设置的环境变量。以下是一个如何在`Next.js`中获取`GitHub Actions`环境变量的例子：\n\n首先，在GitHub Actions的工作流文件中设置环境变量，例如在 `.github/workflows/ci.yml`中：\n\n``` yml\njobs:\n  build:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Checkout code\n        uses: actions/checkout@v2\n      - name: Setup Node.js\n        uses: actions/setup-node@v2\n        with:\n          node-version: 14\n      - name: Install Dependencies\n        run: npm install\n      - name: Build Next.js App\n        env:\n          MY_ENV_VAR: ${{ secrets.MY_SECRET_ENV_VAR }}\n        run: npm run build\n```\n\n在这个例子中，`MY_ENV_VAR`是一个环境变量，它可以是一个秘密值，通过`GitHub Actions`的秘密（secrets）功能来安全地设置。\n\n然后，需要将环境变量添加到 `Next` 项目的配置文件中，在 `next.config.js` 中：\n\n``` js\nmodule.exports = {\n  env: {\n    MY_ENV_VAR: process.env.MY_ENV_VAR,\n  }\n}\n```\n\n### 获取变量\n\n然后，在Next.js的应用代码中，你可以这样获取这个环境变量：\n\n``` js\n// pages/index.js\nexport default function Home() {\n  const myEnvVar = process.env.MY_ENV_VAR;\n  return (\n    <div>\n      <p>The environment variable is: {myEnvVar || 'undefined'}</p>\n    </div>\n  );\n}\n```\n\n在这段代码中，`process.env.MY_ENV_VAR` 将会获取在 `GitHub Actions` 中设置的环境变量`MY_ENV_VAR`的值。如果环境变量存在，它将被显示在页面上；如果不存在，则会显示`'undefined'`。"]},"__N_SSG":true}