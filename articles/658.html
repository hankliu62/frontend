<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>前端小技术集合 - H.L Frontend</title><link rel="icon" href="/frontend/favicon.ico"/><meta name="description" content="H.L Frontend，前端技术和工具网站，提供了一系列实用的前端开发工具和功能，技术网站汇总，旨在帮助开发者更加高效地进行前端开发。"/><meta name="keywords" content="前端工具,前端开发,前端开发工具,前端开发工具集合,toolbox,frontend,卡鲁秋,Hank,HankLiu"/><meta name="author" content="Hank.Liu"/><meta name="copyright" content="卡鲁秋"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/><meta name="next-head-count" content="9"/><link rel="stylesheet" href="/frontend/styles/animate.css/@4.1.1/animate.css"/><link rel="preload" href="/frontend/_next/static/css/48e12760546808a2.css" as="style"/><link rel="stylesheet" href="/frontend/_next/static/css/48e12760546808a2.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/frontend/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/frontend/_next/static/chunks/webpack-93c0980eb9a5a364.js" defer=""></script><script src="/frontend/_next/static/chunks/framework-0e8d27528ba61906.js" defer=""></script><script src="/frontend/_next/static/chunks/main-d236bc00457e5dc2.js" defer=""></script><script src="/frontend/_next/static/chunks/pages/_app-d90534c1986642b8.js" defer=""></script><script src="/frontend/_next/static/chunks/4853-4e02ebf21637e379.js" defer=""></script><script src="/frontend/_next/static/chunks/3239-4699acf95684b42e.js" defer=""></script><script src="/frontend/_next/static/chunks/1664-e769dc1505626ddd.js" defer=""></script><script src="/frontend/_next/static/chunks/pages/articles/%5Bid%5D-15cbf11aeca29499.js" defer=""></script><script src="/frontend/_next/static/MQUtFiptr90W41domt60c/_buildManifest.js" defer=""></script><script src="/frontend/_next/static/MQUtFiptr90W41domt60c/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="flex h-full min-h-[100vh] w-full flex-col" style="flex-direction:column;min-height:100vh"><main class="flex flex-1 grow-[1] flex-col" style="flex:1"><div class="flex h-full flex-1 flex-col" style="position:relative"><div class="flex space-x-6 bg-white p-6"><div class="flex-1 overflow-x-hidden"><div class="ant-card ant-card-bordered article-card min-h-full !border-[#d9d9d9] css-1okl62o"><div class="ant-card-body"><article><div class="mx-auto mb-[36px] max-w-[1045px] px-[30px] lg:mb-[52px] lg:flex lg:px-0"><div id="banner" class="media-wrapper image-media-wrapper w-full overflow-hidden rounded-[8px] border-[1px] border-solid border-[#1D2129] lg:ml-0 lg:h-[320px] lg:w-[500px]"><div class="hidden before"></div><div class="hidden after"></div><div class="scale-103 h-full w-full border-[8px] border-solid border-white lg:scale-100 cover-wrapper"><img class="h-full w-full rounded-md object-cover cover" src="/frontend/dashboard/images/banner.png" alt=""/></div></div><div class="mt-[60px] overflow-hidden lg:ml-[32px] lg:mt-0 lg:flex-1"><h1 class="leading-130 montserrat-bold mb-[9px] text-[36px] font-medium text-[#1D2129] lg:mb-[8px]">使用 AbortController 实现异步操作控制</h1><div class="mb-[9px] flex whitespace-nowrap lg:mb-[10px]"><div class="leading-120 cursor-pointer truncate text-[24px] font-normal text-[#1D2129] underline-offset-2 hover:underline lg:text-[20px]" aria-hidden="true"># VOL.<!-- -->658</div><div class="leading-120 ml-[48px] text-[24px] font-normal text-[#1D2129] lg:ml-[32px] lg:text-[20px]">2024/04/13</div></div><div class="mb-[12px] flex flex-wrap lg:mb-0"><div class="leading-150 mb-[12px] mr-[18px] rounded-[30px] border border-solid border-[#1D2129] px-[24px] py-[6px] text-[20px] font-normal text-[#1D2129] lg:mb-[12px] lg:mr-[10px] lg:rounded-[20px] lg:px-[16px] lg:py-[4px] lg:text-[14px]">blog</div><div class="leading-150 mb-[12px] mr-[18px] rounded-[30px] border border-solid border-[#1D2129] px-[24px] py-[6px] text-[20px] font-normal text-[#1D2129] lg:mb-[12px] lg:mr-[10px] lg:rounded-[20px] lg:px-[16px] lg:py-[4px] lg:text-[14px]">html</div></div><div class="my-[30px] hidden w-[213px] border border-[#1D2129] lg:mb-[20px] lg:mt-[8px] lg:block"></div><div class="lg:rounded-0 rounded-[12px] bg-white/30 p-[36px] lg:flex lg:bg-transparent lg:p-0"><div class="float-left h-[118px] w-[118px] lg:float-none lg:h-[112px] lg:w-[112px]"><img src="https://avatars.githubusercontent.com/u/8088864?v=4" class="h-full w-full rounded-[8px] object-cover lg:rounded-[12px]" alt=""/></div><div class="lg:ml-[32px] lg:flex-1 lg:overflow-hidden"><div class="mb-[10px] flex h-[118px] flex-col justify-center pl-[36px] lg:h-auto lg:flex-row lg:items-center lg:justify-between lg:pl-0"><div class="leading-130 montserrat-bold mb-[12px] w-full truncate text-[30px] font-medium text-[#1D2129] lg:mb-0 lg:flex-1 lg:text-[24px]">hankliu62</div><a class="leading-170 ml-0 whitespace-pre-wrap text-[20px] font-normal !text-[#1D2129] !underline hover:!text-[#1D2129] hover:!underline focus:!text-[#1D2129] lg:ml-[5px] lg:text-[14px]" href="https://github.com/hankliu62" target="_blank" rel="noreferrer">TA的个人名片</a></div><div class="leading-170 text-[20px] font-normal text-[#4E5969] lg:text-[14px]">HankLiu前端开发工程师，精通前端，涉猎后端，对前端有着浓厚的兴趣，希望能够在前端这条路上一直走下去。努力去听风的声音，不必在意风的方向。</div></div></div></div></div><div class="ant-divider css-1okl62o ant-divider-horizontal !mt-0 !border-[#bfc3c7]" role="separator"></div><section><div><div class="ant-skeleton ant-skeleton-active css-1okl62o"><div class="ant-skeleton-content"><h3 class="ant-skeleton-title" style="width:38%"></h3><ul class="ant-skeleton-paragraph"><li></li><li></li><li style="width:61%"></li></ul></div></div></div></section></article></div></div></div><div class="w-64 bg-white"><div><div class=""><div class="ant-collapse ant-collapse-icon-position-end question-menus-collapse css-1okl62o"><div class="ant-collapse-item ant-collapse-item-active"><div class="ant-collapse-header" aria-expanded="true" aria-disabled="false" role="button" tabindex="0"><div class="ant-collapse-expand-icon"><span role="img" aria-label="right" class="anticon anticon-right ant-collapse-arrow"><svg viewBox="64 64 896 896" focusable="false" style="-ms-transform:rotate(90deg);transform:rotate(90deg)" data-icon="right" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"></path></svg></span></div><span class="ant-collapse-header-text"><span class="text-base">目录</span></span><div class="ant-collapse-extra"><div class="-mr-2">收起</div></div></div><div class="ant-collapse-content ant-collapse-content-active"><div class="ant-collapse-content-box"><ul class="max-h-[620px] list-none space-y-3 overflow-y-auto text-slate-500 dark:text-slate-400"><li id="## 使用 AbortController 实现异步操作控制

### 背景

在 `JavaScript` 中，我们经常需要执行一些异步操作，例如发起网络请求、执行定时任务等。然而，有时候我们希望能够在某些条件下中止这些异步操作，以节省资源或提高用户体验。这时候，`AbortController` 就派上了用场。

`AbortController` 是一个可以用来控制异步操作的对象，它可以与 `Promise`、`Fetch API` 等配合使用，实现在异步操作进行中中止操作的功能。本文将介绍 `AbortController` 的基本用法，并提供详细的示例来说明其在实际场景中的应用。

### 基本用法
`AbortController` 提供了两个主要的方法：`abort()` 和 `signal` 属性。

- **abort()**: 调用该方法可以中止与 `AbortController` 相关联的异步操作。
- **signal**: 这是一个只读属性，它返回一个 `AbortSignal` 对象，用于监听异步操作的中止状态。
下面是一个基本的示例：

``` javascript

const controller = new AbortController();
const signal = controller.signal;

// 监听中止信号
signal.addEventListener(&#x27;abort&#x27;, () =&gt; {
  console.log(&#x27;Operation aborted&#x27;);
});

// 5秒后中止操作
setTimeout(() =&gt; {
  controller.abort();
}, 5000);
```

在这个示例中，我们创建了一个 `AbortController` 对象 `controller`，并从中获取了 `signal` 属性。然后，我们通过 `setTimeout()` 函数设定了一个 `5` 秒后的定时任务，当定时任务执行时，调用了 `controller.abort()` 方法来中止操作。同时，我们通过 `signal.addEventListener()` 方法监听了中止信号，并在中止时输出了一条日志。

### 结合 Fetch API

`AbortController` 最常见的用法之一是与 `Fetch API` 结合使用，实现中止网络请求的功能。下面是一个示例：

``` javascript

const controller = new AbortController();
const signal = controller.signal;

fetch(&#x27;https://api.example.com/data&#x27;, { signal })
  .then(response =&gt; response.json())
  .then(data =&gt; console.log(data))
  .catch(error =&gt; {
    if (error.name === &#x27;AbortError&#x27;) {
      console.log(&#x27;Request aborted&#x27;);
    } else {
      console.error(&#x27;Error:&#x27;, error);
    }
  });

// 10秒后中止请求
setTimeout(() =&gt; {
  controller.abort();
}, 10000);
```

在这个示例中，我们创建了一个 `AbortController` 对象 `controller`，并将其与 `Fetch API` 中的 `signal` 属性关联起来。然后，我们发起了一个网络请求，当请求完成时输出了返回的数据，如果请求被中止，则捕获到 `AbortError` 并输出一条相应的日志。最后，我们设置了一个 10 秒后的定时任务，当定时任务执行时，调用了 `controller.abort()` 方法来中止网络请求。

### 结合 Promise

除了与 `Fetch API` 结合使用外，`AbortController` 还可以与 `Promise` 结合使用，实现中止 `Promise` 执行的功能。下面是一个示例：

``` javascript

function fetchData(signal) {
  return new Promise((resolve, reject) =&gt; {
    setTimeout(() =&gt; {
      if (signal.aborted) {
        reject(new DOMException(&#x27;AbortError&#x27;, &#x27;AbortError&#x27;));
      } else {
        resolve(&#x27;Data fetched successfully&#x27;);
      }
    }, 3000);
  });
}

const controller = new AbortController();
const signal = controller.signal;

fetchData(signal)
  .then(data =&gt; console.log(data))
  .catch(error =&gt; {
    if (error.name === &#x27;AbortError&#x27;) {
      console.log(&#x27;Operation aborted&#x27;);
    } else {
      console.error(&#x27;Error:&#x27;, error);
    }
  });

// 5秒后中止操作
setTimeout(() =&gt; {
  controller.abort();
}, 5000);
```

在这个示例中，我们定义了一个 `fetchData()` 函数，该函数返回一个 `Promise` 对象，在一定时间后返回数据或者中止操作。然后，我们创建了一个 `AbortController` 对象 `controller`，并将其与 `Promise` 关联起来。最后，我们设置了一个 `5` 秒后的定时任务，当定时任务执行时，调用了 `controller.abort()` 方法来中止 `Promise` 执行。

### Axios 请求通过 CancelToken 来取消请求

`Axios` 自带有取消请求的借口，在 `Axios` 中通过 `CancelToken` 取消请求发送。下面是一个示例：

``` javascript
/ 引入 Axios 库
const axios = require(&#x27;axios&#x27;);

// 创建一个 CancelToken.source 对象
const { CancelToken, axiosInstance } = axios;
const source = CancelToken.source();

// 创建一个 Axios 请求
const request = axiosInstance.get(&#x27;https://api.example.com/data&#x27;, {
  cancelToken: source.token // 传递 CancelToken 对象到请求配置中
});

// 设置一个定时器，在 3 秒后取消请求
setTimeout(() =&gt; {
  source.cancel(&#x27;Request canceled due to timeout&#x27;);
}, 3000);

// 发起请求并处理响应
request.then(response =&gt; {
  console.log(&#x27;Response:&#x27;, response.data);
}).catch(error =&gt; {
  if (axios.isCancel(error)) {
    console.log(&#x27;Request canceled:&#x27;, error.message);
  } else {
    console.error(&#x27;Error:&#x27;, error);
  }
});
```

在这个示例中，我们首先引入 `Axios` 库，并创建了一个 `CancelToken.source` 对象 `source`。然后，我们发起一个 `GET` 请求，并在请求配置中传递了 `cancelToken: source.token`，以便 `Axios` 知道我们要使用哪个 `CancelToken` 来取消请求。

接着，我们设置了一个定时器，在 `3` 秒后调用 `source.cancel()` 方法取消请求，并传递了一个取消原因。最后，我们发起请求，并在 `.then()` 和 `.catch()` 方法中分别处理响应和错误。如果请求被取消，我们通过 `axios.isCancel(error)` 来检查错误类型，并输出相应的日志。

### XMLHttpRequest 通过 abort 来取消请求

在现代浏览器环境中，我们可以使用 `XMLHttpRequest（XHR）` 对象来发起网络请求，`XHR` 里面存在 `abort` 能用来取消这些请求。以下是一个使用XHR取消请求的示例：

``` javascript
// 创建一个XHR对象
const xhr = new XMLHttpRequest();

// 监听请求状态变化
xhr.onreadystatechange = function() {
  // 请求完成并且响应状态为200时，处理响应
  if (xhr.readyState === XMLHttpRequest.DONE &amp;&amp; xhr.status === 200) {
    console.log(&#x27;Response:&#x27;, xhr.responseText);
  }
};

// 准备发送请求，但不发送
xhr.open(&#x27;GET&#x27;, &#x27;https://api.example.com/data&#x27;);

// 发送请求
xhr.send();

// 设置一个定时器，在3秒后取消请求
setTimeout(() =&gt; {
  xhr.abort();
  console.log(&#x27;Request canceled&#x27;);
}, 3000);
```

在这个示例中，我们首先创建了一个 `XMLHttpRequest` 对象 `xhr`，并设置了它的 `onreadystatechange` 事件处理程序来监听请求状态变化。然后，我们调用 `xhr.open()` 方法来准备发送一个 `GET` 请求到指定的 `URL`，但并不发送请求。接着，我们调用 `xhr.send()` 方法来实际发送请求。

同时，我们设置了一个定时器，在3秒后调用 `xhr.abort()` 方法来取消请求。当调用 `xhr.abort()` 方法时，`XHR` 对象将会立即终止当前的网络请求。

最后，当请求完成并且响应状态为 `200` 时，我们通过 `xhr.responseText` 属性获取响应数据，并输出到控制台。

### 结论

`AbortController` 是一个非常有用的工具，它为我们提供了在异步操作进行中中止操作的能力。通过结合 `Fetch API`、`Promise` 等，我们可以在网络请求、定时任务等场景中灵活地使用 `AbortController`，从而提高代码的可控性和可靠性。希望本文的介绍能够帮助你更好地理解和应用 `AbortController`。" class="border-0 !border-l-2 border-solid border-transparent pr-[16px] text-base !border-sky-500"><a class="w-full overflow-hidden !text-[#515767] !text-sky-500" href="/frontend/articles/658#%E4%BD%BF%E7%94%A8-abortcontroller-%E5%AE%9E%E7%8E%B0%E5%BC%82%E6%AD%A5%E6%93%8D%E4%BD%9C%E6%8E%A7%E5%88%B6--###-%E8%83%8C%E6%99%AF--%E5%9C%A8-%60javascript%60-%E4%B8%AD%E6%88%91%E4%BB%AC%E7%BB%8F%E5%B8%B8%E9%9C%80%E8%A6%81%E6%89%A7%E8%A1%8C%E4%B8%80%E4%BA%9B%E5%BC%82%E6%AD%A5%E6%93%8D%E4%BD%9C%E4%BE%8B%E5%A6%82%E5%8F%91%E8%B5%B7%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E6%89%A7%E8%A1%8C%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E7%AD%89%E7%84%B6%E8%80%8C%E6%9C%89%E6%97%B6%E5%80%99%E6%88%91%E4%BB%AC%E5%B8%8C%E6%9C%9B%E8%83%BD%E5%A4%9F%E5%9C%A8%E6%9F%90%E4%BA%9B%E6%9D%A1%E4%BB%B6%E4%B8%8B%E4%B8%AD%E6%AD%A2%E8%BF%99%E4%BA%9B%E5%BC%82%E6%AD%A5%E6%93%8D%E4%BD%9C%E4%BB%A5%E8%8A%82%E7%9C%81%E8%B5%84%E6%BA%90%E6%88%96%E6%8F%90%E9%AB%98%E7%94%A8%E6%88%B7%E4%BD%93%E9%AA%8C%E8%BF%99%E6%97%B6%E5%80%99%60abortcontroller%60-%E5%B0%B1%E6%B4%BE%E4%B8%8A%E4%BA%86%E7%94%A8%E5%9C%BA--%60abortcontroller%60-%E6%98%AF%E4%B8%80%E4%B8%AA%E5%8F%AF%E4%BB%A5%E7%94%A8%E6%9D%A5%E6%8E%A7%E5%88%B6%E5%BC%82%E6%AD%A5%E6%93%8D%E4%BD%9C%E7%9A%84%E5%AF%B9%E8%B1%A1%E5%AE%83%E5%8F%AF%E4%BB%A5%E4%B8%8E-%60promise%60%60fetch-api%60-%E7%AD%89%E9%85%8D%E5%90%88%E4%BD%BF%E7%94%A8%E5%AE%9E%E7%8E%B0%E5%9C%A8%E5%BC%82%E6%AD%A5%E6%93%8D%E4%BD%9C%E8%BF%9B%E8%A1%8C%E4%B8%AD%E4%B8%AD%E6%AD%A2%E6%93%8D%E4%BD%9C%E7%9A%84%E5%8A%9F%E8%83%BD%E6%9C%AC%E6%96%87%E5%B0%86%E4%BB%8B%E7%BB%8D-%60abortcontroller%60-%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95%E5%B9%B6%E6%8F%90%E4%BE%9B%E8%AF%A6%E7%BB%86%E7%9A%84%E7%A4%BA%E4%BE%8B%E6%9D%A5%E8%AF%B4%E6%98%8E%E5%85%B6%E5%9C%A8%E5%AE%9E%E9%99%85%E5%9C%BA%E6%99%AF%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8--###-%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95-%60abortcontroller%60-%E6%8F%90%E4%BE%9B%E4%BA%86%E4%B8%A4%E4%B8%AA%E4%B8%BB%E8%A6%81%E7%9A%84%E6%96%B9%E6%B3%95%60abort()%60-%E5%92%8C-%60signal%60-%E5%B1%9E%E6%80%A7----**abort()**:-%E8%B0%83%E7%94%A8%E8%AF%A5%E6%96%B9%E6%B3%95%E5%8F%AF%E4%BB%A5%E4%B8%AD%E6%AD%A2%E4%B8%8E-%60abortcontroller%60-%E7%9B%B8%E5%85%B3%E8%81%94%E7%9A%84%E5%BC%82%E6%AD%A5%E6%93%8D%E4%BD%9C---**signal**:-%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E5%8F%AA%E8%AF%BB%E5%B1%9E%E6%80%A7%E5%AE%83%E8%BF%94%E5%9B%9E%E4%B8%80%E4%B8%AA-%60abortsignal%60-%E5%AF%B9%E8%B1%A1%E7%94%A8%E4%BA%8E%E7%9B%91%E5%90%AC%E5%BC%82%E6%AD%A5%E6%93%8D%E4%BD%9C%E7%9A%84%E4%B8%AD%E6%AD%A2%E7%8A%B6%E6%80%81-%E4%B8%8B%E9%9D%A2%E6%98%AF%E4%B8%80%E4%B8%AA%E5%9F%BA%E6%9C%AC%E7%9A%84%E7%A4%BA%E4%BE%8B--%60%60%60-javascript--const-controller-=-new-abortcontroller();-const-signal-=-controller.signal;--/-%E7%9B%91%E5%90%AC%E4%B8%AD%E6%AD%A2%E4%BF%A1%E5%8F%B7-signal.addeventlistener(&#x27;abort&#x27;,-()-=%3E-{---console.log(&#x27;operation-aborted&#x27;);-});--/-5%E7%A7%92%E5%90%8E%E4%B8%AD%E6%AD%A2%E6%93%8D%E4%BD%9C-settimeout(()-=%3E-{---controller.abort();-},-5000);-%60%60%60--%E5%9C%A8%E8%BF%99%E4%B8%AA%E7%A4%BA%E4%BE%8B%E4%B8%AD%E6%88%91%E4%BB%AC%E5%88%9B%E5%BB%BA%E4%BA%86%E4%B8%80%E4%B8%AA-%60abortcontroller%60-%E5%AF%B9%E8%B1%A1-%60controller%60%E5%B9%B6%E4%BB%8E%E4%B8%AD%E8%8E%B7%E5%8F%96%E4%BA%86-%60signal%60-%E5%B1%9E%E6%80%A7%E7%84%B6%E5%90%8E%E6%88%91%E4%BB%AC%E9%80%9A%E8%BF%87-%60settimeout()%60-%E5%87%BD%E6%95%B0%E8%AE%BE%E5%AE%9A%E4%BA%86%E4%B8%80%E4%B8%AA-%605%60-%E7%A7%92%E5%90%8E%E7%9A%84%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E5%BD%93%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E6%89%A7%E8%A1%8C%E6%97%B6%E8%B0%83%E7%94%A8%E4%BA%86-%60controller.abort()%60-%E6%96%B9%E6%B3%95%E6%9D%A5%E4%B8%AD%E6%AD%A2%E6%93%8D%E4%BD%9C%E5%90%8C%E6%97%B6%E6%88%91%E4%BB%AC%E9%80%9A%E8%BF%87-%60signal.addeventlistener()%60-%E6%96%B9%E6%B3%95%E7%9B%91%E5%90%AC%E4%BA%86%E4%B8%AD%E6%AD%A2%E4%BF%A1%E5%8F%B7%E5%B9%B6%E5%9C%A8%E4%B8%AD%E6%AD%A2%E6%97%B6%E8%BE%93%E5%87%BA%E4%BA%86%E4%B8%80%E6%9D%A1%E6%97%A5%E5%BF%97--###-%E7%BB%93%E5%90%88-fetch-api--%60abortcontroller%60-%E6%9C%80%E5%B8%B8%E8%A7%81%E7%9A%84%E7%94%A8%E6%B3%95%E4%B9%8B%E4%B8%80%E6%98%AF%E4%B8%8E-%60fetch-api%60-%E7%BB%93%E5%90%88%E4%BD%BF%E7%94%A8%E5%AE%9E%E7%8E%B0%E4%B8%AD%E6%AD%A2%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E7%9A%84%E5%8A%9F%E8%83%BD%E4%B8%8B%E9%9D%A2%E6%98%AF%E4%B8%80%E4%B8%AA%E7%A4%BA%E4%BE%8B--%60%60%60-javascript--const-controller-=-new-abortcontroller();-const-signal-=-controller.signal;--fetch(&#x27;https:/api.example.com/data&#x27;,-{-signal-})---.then(response-=%3E-response.json())---.then(data-=%3E-console.log(data))---.catch(error-=%3E-{-----if-(error.name-===-&#x27;aborterror&#x27;)-{-------console.log(&#x27;request-aborted&#x27;);-----}-else-{-------console.error(&#x27;error:&#x27;,-error);-----}---});--/-10%E7%A7%92%E5%90%8E%E4%B8%AD%E6%AD%A2%E8%AF%B7%E6%B1%82-settimeout(()-=%3E-{---controller.abort();-},-10000);-%60%60%60--%E5%9C%A8%E8%BF%99%E4%B8%AA%E7%A4%BA%E4%BE%8B%E4%B8%AD%E6%88%91%E4%BB%AC%E5%88%9B%E5%BB%BA%E4%BA%86%E4%B8%80%E4%B8%AA-%60abortcontroller%60-%E5%AF%B9%E8%B1%A1-%60controller%60%E5%B9%B6%E5%B0%86%E5%85%B6%E4%B8%8E-%60fetch-api%60-%E4%B8%AD%E7%9A%84-%60signal%60-%E5%B1%9E%E6%80%A7%E5%85%B3%E8%81%94%E8%B5%B7%E6%9D%A5%E7%84%B6%E5%90%8E%E6%88%91%E4%BB%AC%E5%8F%91%E8%B5%B7%E4%BA%86%E4%B8%80%E4%B8%AA%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E5%BD%93%E8%AF%B7%E6%B1%82%E5%AE%8C%E6%88%90%E6%97%B6%E8%BE%93%E5%87%BA%E4%BA%86%E8%BF%94%E5%9B%9E%E7%9A%84%E6%95%B0%E6%8D%AE%E5%A6%82%E6%9E%9C%E8%AF%B7%E6%B1%82%E8%A2%AB%E4%B8%AD%E6%AD%A2%E5%88%99%E6%8D%95%E8%8E%B7%E5%88%B0-%60aborterror%60-%E5%B9%B6%E8%BE%93%E5%87%BA%E4%B8%80%E6%9D%A1%E7%9B%B8%E5%BA%94%E7%9A%84%E6%97%A5%E5%BF%97%E6%9C%80%E5%90%8E%E6%88%91%E4%BB%AC%E8%AE%BE%E7%BD%AE%E4%BA%86%E4%B8%80%E4%B8%AA-10-%E7%A7%92%E5%90%8E%E7%9A%84%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E5%BD%93%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E6%89%A7%E8%A1%8C%E6%97%B6%E8%B0%83%E7%94%A8%E4%BA%86-%60controller.abort()%60-%E6%96%B9%E6%B3%95%E6%9D%A5%E4%B8%AD%E6%AD%A2%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82--###-%E7%BB%93%E5%90%88-promise--%E9%99%A4%E4%BA%86%E4%B8%8E-%60fetch-api%60-%E7%BB%93%E5%90%88%E4%BD%BF%E7%94%A8%E5%A4%96%60abortcontroller%60-%E8%BF%98%E5%8F%AF%E4%BB%A5%E4%B8%8E-%60promise%60-%E7%BB%93%E5%90%88%E4%BD%BF%E7%94%A8%E5%AE%9E%E7%8E%B0%E4%B8%AD%E6%AD%A2-%60promise%60-%E6%89%A7%E8%A1%8C%E7%9A%84%E5%8A%9F%E8%83%BD%E4%B8%8B%E9%9D%A2%E6%98%AF%E4%B8%80%E4%B8%AA%E7%A4%BA%E4%BE%8B--%60%60%60-javascript--function-fetchdata(signal)-{---return-new-promise((resolve,-reject)-=%3E-{-----settimeout(()-=%3E-{-------if-(signal.aborted)-{---------reject(new-domexception(&#x27;aborterror&#x27;,-&#x27;aborterror&#x27;));-------}-else-{---------resolve(&#x27;data-fetched-successfully&#x27;);-------}-----},-3000);---});-}--const-controller-=-new-abortcontroller();-const-signal-=-controller.signal;--fetchdata(signal)---.then(data-=%3E-console.log(data))---.catch(error-=%3E-{-----if-(error.name-===-&#x27;aborterror&#x27;)-{-------console.log(&#x27;operation-aborted&#x27;);-----}-else-{-------console.error(&#x27;error:&#x27;,-error);-----}---});--/-5%E7%A7%92%E5%90%8E%E4%B8%AD%E6%AD%A2%E6%93%8D%E4%BD%9C-settimeout(()-=%3E-{---controller.abort();-},-5000);-%60%60%60--%E5%9C%A8%E8%BF%99%E4%B8%AA%E7%A4%BA%E4%BE%8B%E4%B8%AD%E6%88%91%E4%BB%AC%E5%AE%9A%E4%B9%89%E4%BA%86%E4%B8%80%E4%B8%AA-%60fetchdata()%60-%E5%87%BD%E6%95%B0%E8%AF%A5%E5%87%BD%E6%95%B0%E8%BF%94%E5%9B%9E%E4%B8%80%E4%B8%AA-%60promise%60-%E5%AF%B9%E8%B1%A1%E5%9C%A8%E4%B8%80%E5%AE%9A%E6%97%B6%E9%97%B4%E5%90%8E%E8%BF%94%E5%9B%9E%E6%95%B0%E6%8D%AE%E6%88%96%E8%80%85%E4%B8%AD%E6%AD%A2%E6%93%8D%E4%BD%9C%E7%84%B6%E5%90%8E%E6%88%91%E4%BB%AC%E5%88%9B%E5%BB%BA%E4%BA%86%E4%B8%80%E4%B8%AA-%60abortcontroller%60-%E5%AF%B9%E8%B1%A1-%60controller%60%E5%B9%B6%E5%B0%86%E5%85%B6%E4%B8%8E-%60promise%60-%E5%85%B3%E8%81%94%E8%B5%B7%E6%9D%A5%E6%9C%80%E5%90%8E%E6%88%91%E4%BB%AC%E8%AE%BE%E7%BD%AE%E4%BA%86%E4%B8%80%E4%B8%AA-%605%60-%E7%A7%92%E5%90%8E%E7%9A%84%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E5%BD%93%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E6%89%A7%E8%A1%8C%E6%97%B6%E8%B0%83%E7%94%A8%E4%BA%86-%60controller.abort()%60-%E6%96%B9%E6%B3%95%E6%9D%A5%E4%B8%AD%E6%AD%A2-%60promise%60-%E6%89%A7%E8%A1%8C--###-axios-%E8%AF%B7%E6%B1%82%E9%80%9A%E8%BF%87-canceltoken-%E6%9D%A5%E5%8F%96%E6%B6%88%E8%AF%B7%E6%B1%82--%60axios%60-%E8%87%AA%E5%B8%A6%E6%9C%89%E5%8F%96%E6%B6%88%E8%AF%B7%E6%B1%82%E7%9A%84%E5%80%9F%E5%8F%A3%E5%9C%A8-%60axios%60-%E4%B8%AD%E9%80%9A%E8%BF%87-%60canceltoken%60-%E5%8F%96%E6%B6%88%E8%AF%B7%E6%B1%82%E5%8F%91%E9%80%81%E4%B8%8B%E9%9D%A2%E6%98%AF%E4%B8%80%E4%B8%AA%E7%A4%BA%E4%BE%8B--%60%60%60-javascript-/-%E5%BC%95%E5%85%A5-axios-%E5%BA%93-const-axios-=-require(&#x27;axios&#x27;);--/-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA-canceltoken.source-%E5%AF%B9%E8%B1%A1-const-{-canceltoken,-axiosinstance-}-=-axios;-const-source-=-canceltoken.source();--/-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA-axios-%E8%AF%B7%E6%B1%82-const-request-=-axiosinstance.get(&#x27;https:/api.example.com/data&#x27;,-{---canceltoken:-source.token-/-%E4%BC%A0%E9%80%92-canceltoken-%E5%AF%B9%E8%B1%A1%E5%88%B0%E8%AF%B7%E6%B1%82%E9%85%8D%E7%BD%AE%E4%B8%AD-});--/-%E8%AE%BE%E7%BD%AE%E4%B8%80%E4%B8%AA%E5%AE%9A%E6%97%B6%E5%99%A8%E5%9C%A8-3-%E7%A7%92%E5%90%8E%E5%8F%96%E6%B6%88%E8%AF%B7%E6%B1%82-settimeout(()-=%3E-{---source.cancel(&#x27;request-canceled-due-to-timeout&#x27;);-},-3000);--/-%E5%8F%91%E8%B5%B7%E8%AF%B7%E6%B1%82%E5%B9%B6%E5%A4%84%E7%90%86%E5%93%8D%E5%BA%94-request.then(response-=%3E-{---console.log(&#x27;response:&#x27;,-response.data);-}).catch(error-=%3E-{---if-(axios.iscancel(error))-{-----console.log(&#x27;request-canceled:&#x27;,-error.message);---}-else-{-----console.error(&#x27;error:&#x27;,-error);---}-});-%60%60%60--%E5%9C%A8%E8%BF%99%E4%B8%AA%E7%A4%BA%E4%BE%8B%E4%B8%AD%E6%88%91%E4%BB%AC%E9%A6%96%E5%85%88%E5%BC%95%E5%85%A5-%60axios%60-%E5%BA%93%E5%B9%B6%E5%88%9B%E5%BB%BA%E4%BA%86%E4%B8%80%E4%B8%AA-%60canceltoken.source%60-%E5%AF%B9%E8%B1%A1-%60source%60%E7%84%B6%E5%90%8E%E6%88%91%E4%BB%AC%E5%8F%91%E8%B5%B7%E4%B8%80%E4%B8%AA-%60get%60-%E8%AF%B7%E6%B1%82%E5%B9%B6%E5%9C%A8%E8%AF%B7%E6%B1%82%E9%85%8D%E7%BD%AE%E4%B8%AD%E4%BC%A0%E9%80%92%E4%BA%86-%60canceltoken:-source.token%60%E4%BB%A5%E4%BE%BF-%60axios%60-%E7%9F%A5%E9%81%93%E6%88%91%E4%BB%AC%E8%A6%81%E4%BD%BF%E7%94%A8%E5%93%AA%E4%B8%AA-%60canceltoken%60-%E6%9D%A5%E5%8F%96%E6%B6%88%E8%AF%B7%E6%B1%82--%E6%8E%A5%E7%9D%80%E6%88%91%E4%BB%AC%E8%AE%BE%E7%BD%AE%E4%BA%86%E4%B8%80%E4%B8%AA%E5%AE%9A%E6%97%B6%E5%99%A8%E5%9C%A8-%603%60-%E7%A7%92%E5%90%8E%E8%B0%83%E7%94%A8-%60source.cancel()%60-%E6%96%B9%E6%B3%95%E5%8F%96%E6%B6%88%E8%AF%B7%E6%B1%82%E5%B9%B6%E4%BC%A0%E9%80%92%E4%BA%86%E4%B8%80%E4%B8%AA%E5%8F%96%E6%B6%88%E5%8E%9F%E5%9B%A0%E6%9C%80%E5%90%8E%E6%88%91%E4%BB%AC%E5%8F%91%E8%B5%B7%E8%AF%B7%E6%B1%82%E5%B9%B6%E5%9C%A8-%60.then()%60-%E5%92%8C-%60.catch()%60-%E6%96%B9%E6%B3%95%E4%B8%AD%E5%88%86%E5%88%AB%E5%A4%84%E7%90%86%E5%93%8D%E5%BA%94%E5%92%8C%E9%94%99%E8%AF%AF%E5%A6%82%E6%9E%9C%E8%AF%B7%E6%B1%82%E8%A2%AB%E5%8F%96%E6%B6%88%E6%88%91%E4%BB%AC%E9%80%9A%E8%BF%87-%60axios.iscancel(error)%60-%E6%9D%A5%E6%A3%80%E6%9F%A5%E9%94%99%E8%AF%AF%E7%B1%BB%E5%9E%8B%E5%B9%B6%E8%BE%93%E5%87%BA%E7%9B%B8%E5%BA%94%E7%9A%84%E6%97%A5%E5%BF%97--###-xmlhttprequest-%E9%80%9A%E8%BF%87-abort-%E6%9D%A5%E5%8F%96%E6%B6%88%E8%AF%B7%E6%B1%82--%E5%9C%A8%E7%8E%B0%E4%BB%A3%E6%B5%8F%E8%A7%88%E5%99%A8%E7%8E%AF%E5%A2%83%E4%B8%AD%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8-%60xmlhttprequestxhr%60-%E5%AF%B9%E8%B1%A1%E6%9D%A5%E5%8F%91%E8%B5%B7%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%60xhr%60-%E9%87%8C%E9%9D%A2%E5%AD%98%E5%9C%A8-%60abort%60-%E8%83%BD%E7%94%A8%E6%9D%A5%E5%8F%96%E6%B6%88%E8%BF%99%E4%BA%9B%E8%AF%B7%E6%B1%82%E4%BB%A5%E4%B8%8B%E6%98%AF%E4%B8%80%E4%B8%AA%E4%BD%BF%E7%94%A8xhr%E5%8F%96%E6%B6%88%E8%AF%B7%E6%B1%82%E7%9A%84%E7%A4%BA%E4%BE%8B--%60%60%60-javascript-/-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAxhr%E5%AF%B9%E8%B1%A1-const-xhr-=-new-xmlhttprequest();--/-%E7%9B%91%E5%90%AC%E8%AF%B7%E6%B1%82%E7%8A%B6%E6%80%81%E5%8F%98%E5%8C%96-xhr.onreadystatechange-=-function()-{---/-%E8%AF%B7%E6%B1%82%E5%AE%8C%E6%88%90%E5%B9%B6%E4%B8%94%E5%93%8D%E5%BA%94%E7%8A%B6%E6%80%81%E4%B8%BA200%E6%97%B6%E5%A4%84%E7%90%86%E5%93%8D%E5%BA%94---if-(xhr.readystate-===-xmlhttprequest.done-&amp;&amp;-xhr.status-===-200)-{-----console.log(&#x27;response:&#x27;,-xhr.responsetext);---}-};--/-%E5%87%86%E5%A4%87%E5%8F%91%E9%80%81%E8%AF%B7%E6%B1%82%E4%BD%86%E4%B8%8D%E5%8F%91%E9%80%81-xhr.open(&#x27;get&#x27;,-&#x27;https:/api.example.com/data&#x27;);--/-%E5%8F%91%E9%80%81%E8%AF%B7%E6%B1%82-xhr.send();--/-%E8%AE%BE%E7%BD%AE%E4%B8%80%E4%B8%AA%E5%AE%9A%E6%97%B6%E5%99%A8%E5%9C%A83%E7%A7%92%E5%90%8E%E5%8F%96%E6%B6%88%E8%AF%B7%E6%B1%82-settimeout(()-=%3E-{---xhr.abort();---console.log(&#x27;request-canceled&#x27;);-},-3000);-%60%60%60--%E5%9C%A8%E8%BF%99%E4%B8%AA%E7%A4%BA%E4%BE%8B%E4%B8%AD%E6%88%91%E4%BB%AC%E9%A6%96%E5%85%88%E5%88%9B%E5%BB%BA%E4%BA%86%E4%B8%80%E4%B8%AA-%60xmlhttprequest%60-%E5%AF%B9%E8%B1%A1-%60xhr%60%E5%B9%B6%E8%AE%BE%E7%BD%AE%E4%BA%86%E5%AE%83%E7%9A%84-%60onreadystatechange%60-%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F%E6%9D%A5%E7%9B%91%E5%90%AC%E8%AF%B7%E6%B1%82%E7%8A%B6%E6%80%81%E5%8F%98%E5%8C%96%E7%84%B6%E5%90%8E%E6%88%91%E4%BB%AC%E8%B0%83%E7%94%A8-%60xhr.open()%60-%E6%96%B9%E6%B3%95%E6%9D%A5%E5%87%86%E5%A4%87%E5%8F%91%E9%80%81%E4%B8%80%E4%B8%AA-%60get%60-%E8%AF%B7%E6%B1%82%E5%88%B0%E6%8C%87%E5%AE%9A%E7%9A%84-%60url%60%E4%BD%86%E5%B9%B6%E4%B8%8D%E5%8F%91%E9%80%81%E8%AF%B7%E6%B1%82%E6%8E%A5%E7%9D%80%E6%88%91%E4%BB%AC%E8%B0%83%E7%94%A8-%60xhr.send()%60-%E6%96%B9%E6%B3%95%E6%9D%A5%E5%AE%9E%E9%99%85%E5%8F%91%E9%80%81%E8%AF%B7%E6%B1%82--%E5%90%8C%E6%97%B6%E6%88%91%E4%BB%AC%E8%AE%BE%E7%BD%AE%E4%BA%86%E4%B8%80%E4%B8%AA%E5%AE%9A%E6%97%B6%E5%99%A8%E5%9C%A83%E7%A7%92%E5%90%8E%E8%B0%83%E7%94%A8-%60xhr.abort()%60-%E6%96%B9%E6%B3%95%E6%9D%A5%E5%8F%96%E6%B6%88%E8%AF%B7%E6%B1%82%E5%BD%93%E8%B0%83%E7%94%A8-%60xhr.abort()%60-%E6%96%B9%E6%B3%95%E6%97%B6%60xhr%60-%E5%AF%B9%E8%B1%A1%E5%B0%86%E4%BC%9A%E7%AB%8B%E5%8D%B3%E7%BB%88%E6%AD%A2%E5%BD%93%E5%89%8D%E7%9A%84%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82--%E6%9C%80%E5%90%8E%E5%BD%93%E8%AF%B7%E6%B1%82%E5%AE%8C%E6%88%90%E5%B9%B6%E4%B8%94%E5%93%8D%E5%BA%94%E7%8A%B6%E6%80%81%E4%B8%BA-%60200%60-%E6%97%B6%E6%88%91%E4%BB%AC%E9%80%9A%E8%BF%87-%60xhr.responsetext%60-%E5%B1%9E%E6%80%A7%E8%8E%B7%E5%8F%96%E5%93%8D%E5%BA%94%E6%95%B0%E6%8D%AE%E5%B9%B6%E8%BE%93%E5%87%BA%E5%88%B0%E6%8E%A7%E5%88%B6%E5%8F%B0--###-%E7%BB%93%E8%AE%BA--%60abortcontroller%60-%E6%98%AF%E4%B8%80%E4%B8%AA%E9%9D%9E%E5%B8%B8%E6%9C%89%E7%94%A8%E7%9A%84%E5%B7%A5%E5%85%B7%E5%AE%83%E4%B8%BA%E6%88%91%E4%BB%AC%E6%8F%90%E4%BE%9B%E4%BA%86%E5%9C%A8%E5%BC%82%E6%AD%A5%E6%93%8D%E4%BD%9C%E8%BF%9B%E8%A1%8C%E4%B8%AD%E4%B8%AD%E6%AD%A2%E6%93%8D%E4%BD%9C%E7%9A%84%E8%83%BD%E5%8A%9B%E9%80%9A%E8%BF%87%E7%BB%93%E5%90%88-%60fetch-api%60%60promise%60-%E7%AD%89%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E5%9C%A8%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E7%AD%89%E5%9C%BA%E6%99%AF%E4%B8%AD%E7%81%B5%E6%B4%BB%E5%9C%B0%E4%BD%BF%E7%94%A8-%60abortcontroller%60%E4%BB%8E%E8%80%8C%E6%8F%90%E9%AB%98%E4%BB%A3%E7%A0%81%E7%9A%84%E5%8F%AF%E6%8E%A7%E6%80%A7%E5%92%8C%E5%8F%AF%E9%9D%A0%E6%80%A7%E5%B8%8C%E6%9C%9B%E6%9C%AC%E6%96%87%E7%9A%84%E4%BB%8B%E7%BB%8D%E8%83%BD%E5%A4%9F%E5%B8%AE%E5%8A%A9%E4%BD%A0%E6%9B%B4%E5%A5%BD%E5%9C%B0%E7%90%86%E8%A7%A3%E5%92%8C%E5%BA%94%E7%94%A8-%60abortcontroller%60"><div class="truncate" style="padding-left:16px">使用 AbortController 实现异步操作控制

### 背景

在 `JavaScript` 中，我们经常需要执行一些异步操作，例如发起网络请求、执行定时任务等。然而，有时候我们希望能够在某些条件下中止这些异步操作，以节省资源或提高用户体验。这时候，`AbortController` 就派上了用场。

`AbortController` 是一个可以用来控制异步操作的对象，它可以与 `Promise`、`Fetch API` 等配合使用，实现在异步操作进行中中止操作的功能。本文将介绍 `AbortController` 的基本用法，并提供详细的示例来说明其在实际场景中的应用。

### 基本用法
`AbortController` 提供了两个主要的方法：`abort()` 和 `signal` 属性。

- **abort()**: 调用该方法可以中止与 `AbortController` 相关联的异步操作。
- **signal**: 这是一个只读属性，它返回一个 `AbortSignal` 对象，用于监听异步操作的中止状态。
下面是一个基本的示例：

``` javascript

const controller = new AbortController();
const signal = controller.signal;

// 监听中止信号
signal.addEventListener(&#x27;abort&#x27;, () =&gt; {
  console.log(&#x27;Operation aborted&#x27;);
});

// 5秒后中止操作
setTimeout(() =&gt; {
  controller.abort();
}, 5000);
```

在这个示例中，我们创建了一个 `AbortController` 对象 `controller`，并从中获取了 `signal` 属性。然后，我们通过 `setTimeout()` 函数设定了一个 `5` 秒后的定时任务，当定时任务执行时，调用了 `controller.abort()` 方法来中止操作。同时，我们通过 `signal.addEventListener()` 方法监听了中止信号，并在中止时输出了一条日志。

### 结合 Fetch API

`AbortController` 最常见的用法之一是与 `Fetch API` 结合使用，实现中止网络请求的功能。下面是一个示例：

``` javascript

const controller = new AbortController();
const signal = controller.signal;

fetch(&#x27;https://api.example.com/data&#x27;, { signal })
  .then(response =&gt; response.json())
  .then(data =&gt; console.log(data))
  .catch(error =&gt; {
    if (error.name === &#x27;AbortError&#x27;) {
      console.log(&#x27;Request aborted&#x27;);
    } else {
      console.error(&#x27;Error:&#x27;, error);
    }
  });

// 10秒后中止请求
setTimeout(() =&gt; {
  controller.abort();
}, 10000);
```

在这个示例中，我们创建了一个 `AbortController` 对象 `controller`，并将其与 `Fetch API` 中的 `signal` 属性关联起来。然后，我们发起了一个网络请求，当请求完成时输出了返回的数据，如果请求被中止，则捕获到 `AbortError` 并输出一条相应的日志。最后，我们设置了一个 10 秒后的定时任务，当定时任务执行时，调用了 `controller.abort()` 方法来中止网络请求。

### 结合 Promise

除了与 `Fetch API` 结合使用外，`AbortController` 还可以与 `Promise` 结合使用，实现中止 `Promise` 执行的功能。下面是一个示例：

``` javascript

function fetchData(signal) {
  return new Promise((resolve, reject) =&gt; {
    setTimeout(() =&gt; {
      if (signal.aborted) {
        reject(new DOMException(&#x27;AbortError&#x27;, &#x27;AbortError&#x27;));
      } else {
        resolve(&#x27;Data fetched successfully&#x27;);
      }
    }, 3000);
  });
}

const controller = new AbortController();
const signal = controller.signal;

fetchData(signal)
  .then(data =&gt; console.log(data))
  .catch(error =&gt; {
    if (error.name === &#x27;AbortError&#x27;) {
      console.log(&#x27;Operation aborted&#x27;);
    } else {
      console.error(&#x27;Error:&#x27;, error);
    }
  });

// 5秒后中止操作
setTimeout(() =&gt; {
  controller.abort();
}, 5000);
```

在这个示例中，我们定义了一个 `fetchData()` 函数，该函数返回一个 `Promise` 对象，在一定时间后返回数据或者中止操作。然后，我们创建了一个 `AbortController` 对象 `controller`，并将其与 `Promise` 关联起来。最后，我们设置了一个 `5` 秒后的定时任务，当定时任务执行时，调用了 `controller.abort()` 方法来中止 `Promise` 执行。

### Axios 请求通过 CancelToken 来取消请求

`Axios` 自带有取消请求的借口，在 `Axios` 中通过 `CancelToken` 取消请求发送。下面是一个示例：

``` javascript
/ 引入 Axios 库
const axios = require(&#x27;axios&#x27;);

// 创建一个 CancelToken.source 对象
const { CancelToken, axiosInstance } = axios;
const source = CancelToken.source();

// 创建一个 Axios 请求
const request = axiosInstance.get(&#x27;https://api.example.com/data&#x27;, {
  cancelToken: source.token // 传递 CancelToken 对象到请求配置中
});

// 设置一个定时器，在 3 秒后取消请求
setTimeout(() =&gt; {
  source.cancel(&#x27;Request canceled due to timeout&#x27;);
}, 3000);

// 发起请求并处理响应
request.then(response =&gt; {
  console.log(&#x27;Response:&#x27;, response.data);
}).catch(error =&gt; {
  if (axios.isCancel(error)) {
    console.log(&#x27;Request canceled:&#x27;, error.message);
  } else {
    console.error(&#x27;Error:&#x27;, error);
  }
});
```

在这个示例中，我们首先引入 `Axios` 库，并创建了一个 `CancelToken.source` 对象 `source`。然后，我们发起一个 `GET` 请求，并在请求配置中传递了 `cancelToken: source.token`，以便 `Axios` 知道我们要使用哪个 `CancelToken` 来取消请求。

接着，我们设置了一个定时器，在 `3` 秒后调用 `source.cancel()` 方法取消请求，并传递了一个取消原因。最后，我们发起请求，并在 `.then()` 和 `.catch()` 方法中分别处理响应和错误。如果请求被取消，我们通过 `axios.isCancel(error)` 来检查错误类型，并输出相应的日志。

### XMLHttpRequest 通过 abort 来取消请求

在现代浏览器环境中，我们可以使用 `XMLHttpRequest（XHR）` 对象来发起网络请求，`XHR` 里面存在 `abort` 能用来取消这些请求。以下是一个使用XHR取消请求的示例：

``` javascript
// 创建一个XHR对象
const xhr = new XMLHttpRequest();

// 监听请求状态变化
xhr.onreadystatechange = function() {
  // 请求完成并且响应状态为200时，处理响应
  if (xhr.readyState === XMLHttpRequest.DONE &amp;&amp; xhr.status === 200) {
    console.log(&#x27;Response:&#x27;, xhr.responseText);
  }
};

// 准备发送请求，但不发送
xhr.open(&#x27;GET&#x27;, &#x27;https://api.example.com/data&#x27;);

// 发送请求
xhr.send();

// 设置一个定时器，在3秒后取消请求
setTimeout(() =&gt; {
  xhr.abort();
  console.log(&#x27;Request canceled&#x27;);
}, 3000);
```

在这个示例中，我们首先创建了一个 `XMLHttpRequest` 对象 `xhr`，并设置了它的 `onreadystatechange` 事件处理程序来监听请求状态变化。然后，我们调用 `xhr.open()` 方法来准备发送一个 `GET` 请求到指定的 `URL`，但并不发送请求。接着，我们调用 `xhr.send()` 方法来实际发送请求。

同时，我们设置了一个定时器，在3秒后调用 `xhr.abort()` 方法来取消请求。当调用 `xhr.abort()` 方法时，`XHR` 对象将会立即终止当前的网络请求。

最后，当请求完成并且响应状态为 `200` 时，我们通过 `xhr.responseText` 属性获取响应数据，并输出到控制台。

### 结论

`AbortController` 是一个非常有用的工具，它为我们提供了在异步操作进行中中止操作的能力。通过结合 `Fetch API`、`Promise` 等，我们可以在网络请求、定时任务等场景中灵活地使用 `AbortController`，从而提高代码的可控性和可靠性。希望本文的介绍能够帮助你更好地理解和应用 `AbortController`。</div></a></li></ul></div></div></div></div></div></div></div></div></div><div style="position:fixed;z-index:9999;top:16px;left:16px;right:16px;bottom:16px;pointer-events:none"></div></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"article":{"url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/658","repository_url":"https://api.github.com/repos/hankliu62/hankliu62.github.com","labels_url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/658/labels{/name}","comments_url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/658/comments","events_url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/658/events","html_url":"https://github.com/hankliu62/hankliu62.github.com/issues/658","id":2241437443,"node_id":"I_kwDOBiJZIc6FmZ8D","number":658,"title":"使用 AbortController 实现异步操作控制","user":{"login":"hankliu62","id":8088864,"node_id":"MDQ6VXNlcjgwODg4NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8088864?v=4","gravatar_id":"","url":"https://api.github.com/users/hankliu62","html_url":"https://github.com/hankliu62","followers_url":"https://api.github.com/users/hankliu62/followers","following_url":"https://api.github.com/users/hankliu62/following{/other_user}","gists_url":"https://api.github.com/users/hankliu62/gists{/gist_id}","starred_url":"https://api.github.com/users/hankliu62/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hankliu62/subscriptions","organizations_url":"https://api.github.com/users/hankliu62/orgs","repos_url":"https://api.github.com/users/hankliu62/repos","events_url":"https://api.github.com/users/hankliu62/events{/privacy}","received_events_url":"https://api.github.com/users/hankliu62/received_events","type":"User","site_admin":false},"labels":[{"id":688950687,"node_id":"MDU6TGFiZWw2ODg5NTA2ODc=","url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/labels/blog","name":"blog","color":"1677ff","default":false,"description":"博客文章"},{"id":6536875857,"node_id":"LA_kwDOBiJZIc8AAAABhaDPUQ","url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/labels/html","name":"html","color":"13c2c2","default":false,"description":"分类-HTML相关"}],"state":"open","locked":false,"assignee":{"login":"hankliu62","id":8088864,"node_id":"MDQ6VXNlcjgwODg4NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8088864?v=4","gravatar_id":"","url":"https://api.github.com/users/hankliu62","html_url":"https://github.com/hankliu62","followers_url":"https://api.github.com/users/hankliu62/followers","following_url":"https://api.github.com/users/hankliu62/following{/other_user}","gists_url":"https://api.github.com/users/hankliu62/gists{/gist_id}","starred_url":"https://api.github.com/users/hankliu62/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hankliu62/subscriptions","organizations_url":"https://api.github.com/users/hankliu62/orgs","repos_url":"https://api.github.com/users/hankliu62/repos","events_url":"https://api.github.com/users/hankliu62/events{/privacy}","received_events_url":"https://api.github.com/users/hankliu62/received_events","type":"User","site_admin":false},"assignees":[{"login":"hankliu62","id":8088864,"node_id":"MDQ6VXNlcjgwODg4NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8088864?v=4","gravatar_id":"","url":"https://api.github.com/users/hankliu62","html_url":"https://github.com/hankliu62","followers_url":"https://api.github.com/users/hankliu62/followers","following_url":"https://api.github.com/users/hankliu62/following{/other_user}","gists_url":"https://api.github.com/users/hankliu62/gists{/gist_id}","starred_url":"https://api.github.com/users/hankliu62/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hankliu62/subscriptions","organizations_url":"https://api.github.com/users/hankliu62/orgs","repos_url":"https://api.github.com/users/hankliu62/repos","events_url":"https://api.github.com/users/hankliu62/events{/privacy}","received_events_url":"https://api.github.com/users/hankliu62/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2024-04-13T08:45:08Z","updated_at":"2024-04-14T06:10:57Z","closed_at":null,"author_association":"OWNER","active_lock_reason":null,"body":"## 使用 AbortController 实现异步操作控制\n\n### 背景\n\n在 `JavaScript` 中，我们经常需要执行一些异步操作，例如发起网络请求、执行定时任务等。然而，有时候我们希望能够在某些条件下中止这些异步操作，以节省资源或提高用户体验。这时候，`AbortController` 就派上了用场。\n\n`AbortController` 是一个可以用来控制异步操作的对象，它可以与 `Promise`、`Fetch API` 等配合使用，实现在异步操作进行中中止操作的功能。本文将介绍 `AbortController` 的基本用法，并提供详细的示例来说明其在实际场景中的应用。\n\n### 基本用法\n`AbortController` 提供了两个主要的方法：`abort()` 和 `signal` 属性。\n\n- **abort()**: 调用该方法可以中止与 `AbortController` 相关联的异步操作。\n- **signal**: 这是一个只读属性，它返回一个 `AbortSignal` 对象，用于监听异步操作的中止状态。\n下面是一个基本的示例：\n\n``` javascript\n\nconst controller = new AbortController();\nconst signal = controller.signal;\n\n// 监听中止信号\nsignal.addEventListener('abort', () =\u003e {\n  console.log('Operation aborted');\n});\n\n// 5秒后中止操作\nsetTimeout(() =\u003e {\n  controller.abort();\n}, 5000);\n```\n\n在这个示例中，我们创建了一个 `AbortController` 对象 `controller`，并从中获取了 `signal` 属性。然后，我们通过 `setTimeout()` 函数设定了一个 `5` 秒后的定时任务，当定时任务执行时，调用了 `controller.abort()` 方法来中止操作。同时，我们通过 `signal.addEventListener()` 方法监听了中止信号，并在中止时输出了一条日志。\n\n### 结合 Fetch API\n\n`AbortController` 最常见的用法之一是与 `Fetch API` 结合使用，实现中止网络请求的功能。下面是一个示例：\n\n``` javascript\n\nconst controller = new AbortController();\nconst signal = controller.signal;\n\nfetch('https://api.example.com/data', { signal })\n  .then(response =\u003e response.json())\n  .then(data =\u003e console.log(data))\n  .catch(error =\u003e {\n    if (error.name === 'AbortError') {\n      console.log('Request aborted');\n    } else {\n      console.error('Error:', error);\n    }\n  });\n\n// 10秒后中止请求\nsetTimeout(() =\u003e {\n  controller.abort();\n}, 10000);\n```\n\n在这个示例中，我们创建了一个 `AbortController` 对象 `controller`，并将其与 `Fetch API` 中的 `signal` 属性关联起来。然后，我们发起了一个网络请求，当请求完成时输出了返回的数据，如果请求被中止，则捕获到 `AbortError` 并输出一条相应的日志。最后，我们设置了一个 10 秒后的定时任务，当定时任务执行时，调用了 `controller.abort()` 方法来中止网络请求。\n\n### 结合 Promise\n\n除了与 `Fetch API` 结合使用外，`AbortController` 还可以与 `Promise` 结合使用，实现中止 `Promise` 执行的功能。下面是一个示例：\n\n``` javascript\n\nfunction fetchData(signal) {\n  return new Promise((resolve, reject) =\u003e {\n    setTimeout(() =\u003e {\n      if (signal.aborted) {\n        reject(new DOMException('AbortError', 'AbortError'));\n      } else {\n        resolve('Data fetched successfully');\n      }\n    }, 3000);\n  });\n}\n\nconst controller = new AbortController();\nconst signal = controller.signal;\n\nfetchData(signal)\n  .then(data =\u003e console.log(data))\n  .catch(error =\u003e {\n    if (error.name === 'AbortError') {\n      console.log('Operation aborted');\n    } else {\n      console.error('Error:', error);\n    }\n  });\n\n// 5秒后中止操作\nsetTimeout(() =\u003e {\n  controller.abort();\n}, 5000);\n```\n\n在这个示例中，我们定义了一个 `fetchData()` 函数，该函数返回一个 `Promise` 对象，在一定时间后返回数据或者中止操作。然后，我们创建了一个 `AbortController` 对象 `controller`，并将其与 `Promise` 关联起来。最后，我们设置了一个 `5` 秒后的定时任务，当定时任务执行时，调用了 `controller.abort()` 方法来中止 `Promise` 执行。\n\n### Axios 请求通过 CancelToken 来取消请求\n\n`Axios` 自带有取消请求的借口，在 `Axios` 中通过 `CancelToken` 取消请求发送。下面是一个示例：\n\n``` javascript\n/ 引入 Axios 库\nconst axios = require('axios');\n\n// 创建一个 CancelToken.source 对象\nconst { CancelToken, axiosInstance } = axios;\nconst source = CancelToken.source();\n\n// 创建一个 Axios 请求\nconst request = axiosInstance.get('https://api.example.com/data', {\n  cancelToken: source.token // 传递 CancelToken 对象到请求配置中\n});\n\n// 设置一个定时器，在 3 秒后取消请求\nsetTimeout(() =\u003e {\n  source.cancel('Request canceled due to timeout');\n}, 3000);\n\n// 发起请求并处理响应\nrequest.then(response =\u003e {\n  console.log('Response:', response.data);\n}).catch(error =\u003e {\n  if (axios.isCancel(error)) {\n    console.log('Request canceled:', error.message);\n  } else {\n    console.error('Error:', error);\n  }\n});\n```\n\n在这个示例中，我们首先引入 `Axios` 库，并创建了一个 `CancelToken.source` 对象 `source`。然后，我们发起一个 `GET` 请求，并在请求配置中传递了 `cancelToken: source.token`，以便 `Axios` 知道我们要使用哪个 `CancelToken` 来取消请求。\n\n接着，我们设置了一个定时器，在 `3` 秒后调用 `source.cancel()` 方法取消请求，并传递了一个取消原因。最后，我们发起请求，并在 `.then()` 和 `.catch()` 方法中分别处理响应和错误。如果请求被取消，我们通过 `axios.isCancel(error)` 来检查错误类型，并输出相应的日志。\n\n### XMLHttpRequest 通过 abort 来取消请求\n\n在现代浏览器环境中，我们可以使用 `XMLHttpRequest（XHR）` 对象来发起网络请求，`XHR` 里面存在 `abort` 能用来取消这些请求。以下是一个使用XHR取消请求的示例：\n\n``` javascript\n// 创建一个XHR对象\nconst xhr = new XMLHttpRequest();\n\n// 监听请求状态变化\nxhr.onreadystatechange = function() {\n  // 请求完成并且响应状态为200时，处理响应\n  if (xhr.readyState === XMLHttpRequest.DONE \u0026\u0026 xhr.status === 200) {\n    console.log('Response:', xhr.responseText);\n  }\n};\n\n// 准备发送请求，但不发送\nxhr.open('GET', 'https://api.example.com/data');\n\n// 发送请求\nxhr.send();\n\n// 设置一个定时器，在3秒后取消请求\nsetTimeout(() =\u003e {\n  xhr.abort();\n  console.log('Request canceled');\n}, 3000);\n```\n\n在这个示例中，我们首先创建了一个 `XMLHttpRequest` 对象 `xhr`，并设置了它的 `onreadystatechange` 事件处理程序来监听请求状态变化。然后，我们调用 `xhr.open()` 方法来准备发送一个 `GET` 请求到指定的 `URL`，但并不发送请求。接着，我们调用 `xhr.send()` 方法来实际发送请求。\n\n同时，我们设置了一个定时器，在3秒后调用 `xhr.abort()` 方法来取消请求。当调用 `xhr.abort()` 方法时，`XHR` 对象将会立即终止当前的网络请求。\n\n最后，当请求完成并且响应状态为 `200` 时，我们通过 `xhr.responseText` 属性获取响应数据，并输出到控制台。\n\n### 结论\n\n`AbortController` 是一个非常有用的工具，它为我们提供了在异步操作进行中中止操作的能力。通过结合 `Fetch API`、`Promise` 等，我们可以在网络请求、定时任务等场景中灵活地使用 `AbortController`，从而提高代码的可控性和可靠性。希望本文的介绍能够帮助你更好地理解和应用 `AbortController`。","closed_by":null,"reactions":{"url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/658/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/658/timeline","performed_via_github_app":null,"state_reason":null},"menus":["## 使用 AbortController 实现异步操作控制\n\n### 背景\n\n在 `JavaScript` 中，我们经常需要执行一些异步操作，例如发起网络请求、执行定时任务等。然而，有时候我们希望能够在某些条件下中止这些异步操作，以节省资源或提高用户体验。这时候，`AbortController` 就派上了用场。\n\n`AbortController` 是一个可以用来控制异步操作的对象，它可以与 `Promise`、`Fetch API` 等配合使用，实现在异步操作进行中中止操作的功能。本文将介绍 `AbortController` 的基本用法，并提供详细的示例来说明其在实际场景中的应用。\n\n### 基本用法\n`AbortController` 提供了两个主要的方法：`abort()` 和 `signal` 属性。\n\n- **abort()**: 调用该方法可以中止与 `AbortController` 相关联的异步操作。\n- **signal**: 这是一个只读属性，它返回一个 `AbortSignal` 对象，用于监听异步操作的中止状态。\n下面是一个基本的示例：\n\n``` javascript\n\nconst controller = new AbortController();\nconst signal = controller.signal;\n\n// 监听中止信号\nsignal.addEventListener('abort', () =\u003e {\n  console.log('Operation aborted');\n});\n\n// 5秒后中止操作\nsetTimeout(() =\u003e {\n  controller.abort();\n}, 5000);\n```\n\n在这个示例中，我们创建了一个 `AbortController` 对象 `controller`，并从中获取了 `signal` 属性。然后，我们通过 `setTimeout()` 函数设定了一个 `5` 秒后的定时任务，当定时任务执行时，调用了 `controller.abort()` 方法来中止操作。同时，我们通过 `signal.addEventListener()` 方法监听了中止信号，并在中止时输出了一条日志。\n\n### 结合 Fetch API\n\n`AbortController` 最常见的用法之一是与 `Fetch API` 结合使用，实现中止网络请求的功能。下面是一个示例：\n\n``` javascript\n\nconst controller = new AbortController();\nconst signal = controller.signal;\n\nfetch('https://api.example.com/data', { signal })\n  .then(response =\u003e response.json())\n  .then(data =\u003e console.log(data))\n  .catch(error =\u003e {\n    if (error.name === 'AbortError') {\n      console.log('Request aborted');\n    } else {\n      console.error('Error:', error);\n    }\n  });\n\n// 10秒后中止请求\nsetTimeout(() =\u003e {\n  controller.abort();\n}, 10000);\n```\n\n在这个示例中，我们创建了一个 `AbortController` 对象 `controller`，并将其与 `Fetch API` 中的 `signal` 属性关联起来。然后，我们发起了一个网络请求，当请求完成时输出了返回的数据，如果请求被中止，则捕获到 `AbortError` 并输出一条相应的日志。最后，我们设置了一个 10 秒后的定时任务，当定时任务执行时，调用了 `controller.abort()` 方法来中止网络请求。\n\n### 结合 Promise\n\n除了与 `Fetch API` 结合使用外，`AbortController` 还可以与 `Promise` 结合使用，实现中止 `Promise` 执行的功能。下面是一个示例：\n\n``` javascript\n\nfunction fetchData(signal) {\n  return new Promise((resolve, reject) =\u003e {\n    setTimeout(() =\u003e {\n      if (signal.aborted) {\n        reject(new DOMException('AbortError', 'AbortError'));\n      } else {\n        resolve('Data fetched successfully');\n      }\n    }, 3000);\n  });\n}\n\nconst controller = new AbortController();\nconst signal = controller.signal;\n\nfetchData(signal)\n  .then(data =\u003e console.log(data))\n  .catch(error =\u003e {\n    if (error.name === 'AbortError') {\n      console.log('Operation aborted');\n    } else {\n      console.error('Error:', error);\n    }\n  });\n\n// 5秒后中止操作\nsetTimeout(() =\u003e {\n  controller.abort();\n}, 5000);\n```\n\n在这个示例中，我们定义了一个 `fetchData()` 函数，该函数返回一个 `Promise` 对象，在一定时间后返回数据或者中止操作。然后，我们创建了一个 `AbortController` 对象 `controller`，并将其与 `Promise` 关联起来。最后，我们设置了一个 `5` 秒后的定时任务，当定时任务执行时，调用了 `controller.abort()` 方法来中止 `Promise` 执行。\n\n### Axios 请求通过 CancelToken 来取消请求\n\n`Axios` 自带有取消请求的借口，在 `Axios` 中通过 `CancelToken` 取消请求发送。下面是一个示例：\n\n``` javascript\n/ 引入 Axios 库\nconst axios = require('axios');\n\n// 创建一个 CancelToken.source 对象\nconst { CancelToken, axiosInstance } = axios;\nconst source = CancelToken.source();\n\n// 创建一个 Axios 请求\nconst request = axiosInstance.get('https://api.example.com/data', {\n  cancelToken: source.token // 传递 CancelToken 对象到请求配置中\n});\n\n// 设置一个定时器，在 3 秒后取消请求\nsetTimeout(() =\u003e {\n  source.cancel('Request canceled due to timeout');\n}, 3000);\n\n// 发起请求并处理响应\nrequest.then(response =\u003e {\n  console.log('Response:', response.data);\n}).catch(error =\u003e {\n  if (axios.isCancel(error)) {\n    console.log('Request canceled:', error.message);\n  } else {\n    console.error('Error:', error);\n  }\n});\n```\n\n在这个示例中，我们首先引入 `Axios` 库，并创建了一个 `CancelToken.source` 对象 `source`。然后，我们发起一个 `GET` 请求，并在请求配置中传递了 `cancelToken: source.token`，以便 `Axios` 知道我们要使用哪个 `CancelToken` 来取消请求。\n\n接着，我们设置了一个定时器，在 `3` 秒后调用 `source.cancel()` 方法取消请求，并传递了一个取消原因。最后，我们发起请求，并在 `.then()` 和 `.catch()` 方法中分别处理响应和错误。如果请求被取消，我们通过 `axios.isCancel(error)` 来检查错误类型，并输出相应的日志。\n\n### XMLHttpRequest 通过 abort 来取消请求\n\n在现代浏览器环境中，我们可以使用 `XMLHttpRequest（XHR）` 对象来发起网络请求，`XHR` 里面存在 `abort` 能用来取消这些请求。以下是一个使用XHR取消请求的示例：\n\n``` javascript\n// 创建一个XHR对象\nconst xhr = new XMLHttpRequest();\n\n// 监听请求状态变化\nxhr.onreadystatechange = function() {\n  // 请求完成并且响应状态为200时，处理响应\n  if (xhr.readyState === XMLHttpRequest.DONE \u0026\u0026 xhr.status === 200) {\n    console.log('Response:', xhr.responseText);\n  }\n};\n\n// 准备发送请求，但不发送\nxhr.open('GET', 'https://api.example.com/data');\n\n// 发送请求\nxhr.send();\n\n// 设置一个定时器，在3秒后取消请求\nsetTimeout(() =\u003e {\n  xhr.abort();\n  console.log('Request canceled');\n}, 3000);\n```\n\n在这个示例中，我们首先创建了一个 `XMLHttpRequest` 对象 `xhr`，并设置了它的 `onreadystatechange` 事件处理程序来监听请求状态变化。然后，我们调用 `xhr.open()` 方法来准备发送一个 `GET` 请求到指定的 `URL`，但并不发送请求。接着，我们调用 `xhr.send()` 方法来实际发送请求。\n\n同时，我们设置了一个定时器，在3秒后调用 `xhr.abort()` 方法来取消请求。当调用 `xhr.abort()` 方法时，`XHR` 对象将会立即终止当前的网络请求。\n\n最后，当请求完成并且响应状态为 `200` 时，我们通过 `xhr.responseText` 属性获取响应数据，并输出到控制台。\n\n### 结论\n\n`AbortController` 是一个非常有用的工具，它为我们提供了在异步操作进行中中止操作的能力。通过结合 `Fetch API`、`Promise` 等，我们可以在网络请求、定时任务等场景中灵活地使用 `AbortController`，从而提高代码的可控性和可靠性。希望本文的介绍能够帮助你更好地理解和应用 `AbortController`。"]},"__N_SSG":true},"page":"/articles/[id]","query":{"id":"658"},"buildId":"MQUtFiptr90W41domt60c","assetPrefix":"/frontend","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>