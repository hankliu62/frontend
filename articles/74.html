<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>卡鲁秋 - 前端小工具集合</title><link rel="icon" href="/toolbox-frontend/favicon.ico"/><meta name="description" content="卡鲁秋的前端工具网站，提供了一系列实用的前端开发工具和功能，技术网站汇总，旨在帮助开发者更加高效地进行前端开发。"/><meta name="keywords" content="前端工具,前端开发,前端开发工具,前端开发工具集合,toolbox,frontend,卡鲁秋"/><meta name="author" content="Hank.Liu"/><meta name="next-head-count" content="7"/><link rel="stylesheet" href="/toolbox-frontend/styles/animate.css/@4.1.1/animate.css"/><link rel="preload" href="/toolbox-frontend/_next/static/css/9666f2751d5f4cfa.css" as="style"/><link rel="stylesheet" href="/toolbox-frontend/_next/static/css/9666f2751d5f4cfa.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/toolbox-frontend/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/toolbox-frontend/_next/static/chunks/webpack-b2686fccc3362873.js" defer=""></script><script src="/toolbox-frontend/_next/static/chunks/framework-aec4381329cec0e4.js" defer=""></script><script src="/toolbox-frontend/_next/static/chunks/main-82d23b26b43cd32b.js" defer=""></script><script src="/toolbox-frontend/_next/static/chunks/pages/_app-baf3db6f3e140b26.js" defer=""></script><script src="/toolbox-frontend/_next/static/chunks/6396-e9161609a76be07a.js" defer=""></script><script src="/toolbox-frontend/_next/static/chunks/8490-2f2be535c5ee8413.js" defer=""></script><script src="/toolbox-frontend/_next/static/chunks/1664-f865873e77459860.js" defer=""></script><script src="/toolbox-frontend/_next/static/chunks/pages/articles/%5Bid%5D-f54ba9d880ba11c9.js" defer=""></script><script src="/toolbox-frontend/_next/static/rQDidgBY5jj2zjb_Ap18Y/_buildManifest.js" defer=""></script><script src="/toolbox-frontend/_next/static/rQDidgBY5jj2zjb_Ap18Y/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="flex h-full min-h-[100vh] w-full flex-col" style="flex-direction:column;min-height:100vh"><main class="flex flex-1 grow-[1] flex-col" style="flex:1"><div class="flex h-full flex-1 flex-col" style="position:relative"><div class="flex space-x-6 bg-white p-6"><div class="flex-1 overflow-x-hidden"><div class="ant-card ant-card-bordered article-card min-h-full !border-[#d9d9d9] css-12jzuas"><div class="ant-card-body"><article><div class="mx-auto mb-[36px] max-w-[1045px] px-[30px] lg:mb-[52px] lg:flex lg:px-0"><div id="banner" class="media-wrapper image-media-wrapper w-full rounded-[8px] border-[1px] border-solid border-[#1D2129] lg:ml-0 lg:h-[320px] lg:w-[500px]"><div class="hidden before"></div><div class="hidden after"></div><div class="scale-103 h-full w-full border-[8px] border-solid border-white lg:scale-100 cover-wrapper"><img class="h-full w-full rounded-md object-cover cover" src="/toolbox-frontend/dashboard/images/banner.png" alt=""/></div></div><div class="mt-[60px] overflow-hidden lg:ml-[32px] lg:mt-0 lg:flex-1"><h1 class="leading-130 montserrat-bold mb-[9px] text-[36px] font-medium text-[#1D2129] lg:mb-[8px]">浏览器打开网页全过程</h1><div class="mb-[9px] flex whitespace-nowrap lg:mb-[10px]"><div class="leading-120 cursor-pointer truncate text-[24px] font-normal text-[#1D2129] underline-offset-2 hover:underline lg:text-[20px]" aria-hidden="true"># VOL.<!-- -->74</div><div class="leading-120 ml-[48px] text-[24px] font-normal text-[#1D2129] lg:ml-[32px] lg:text-[20px]">2023/07/13</div></div><div class="mb-[12px] flex flex-wrap lg:mb-0"><div class="leading-150 mb-[12px] mr-[18px] rounded-[30px] border border-solid border-[#1D2129] px-[24px] py-[6px] text-[20px] font-normal text-[#1D2129] lg:mb-[12px] lg:mr-[10px] lg:rounded-[20px] lg:px-[16px] lg:py-[4px] lg:text-[14px]">blog</div></div><div class="my-[30px] hidden w-[213px] border border-[#1D2129] lg:mb-[20px] lg:mt-[8px] lg:block"></div><div class="lg:rounded-0 rounded-[12px] bg-white/30 p-[36px] lg:flex lg:bg-transparent lg:p-0"><div class="float-left h-[118px] w-[118px] lg:float-none lg:h-[112px] lg:w-[112px]"><img src="https://avatars.githubusercontent.com/u/8088864?v=4" class="h-full w-full rounded-[8px] object-cover lg:rounded-[12px]" alt=""/></div><div class="lg:ml-[32px] lg:flex-1 lg:overflow-hidden"><div class="mb-[10px] flex h-[118px] flex-col justify-center pl-[36px] lg:h-auto lg:flex-row lg:items-center lg:justify-between lg:pl-0"><div class="leading-130 montserrat-bold mb-[12px] w-full truncate text-[30px] font-medium text-[#1D2129] lg:mb-0 lg:flex-1 lg:text-[24px]">hankliu62</div><a class="leading-170 ml-0 whitespace-pre-wrap text-[20px] font-normal !text-[#1D2129] !underline hover:!text-[#1D2129] hover:!underline focus:!text-[#1D2129] lg:ml-[5px] lg:text-[14px]" href="https://github.com/hankliu62" target="_blank" rel="noreferrer">TA的个人名片</a></div><div class="leading-170 text-[20px] font-normal text-[#4E5969] lg:text-[14px]">HankLiu前端开发工程师，精通前端，涉猎后端，对前端有着浓厚的兴趣，希望能够在前端这条路上一直走下去。努力去听风的声音，不必在意风的方向。</div></div></div></div></div><div class="ant-divider css-12jzuas ant-divider-horizontal !mt-0 !border-[#bfc3c7]" role="separator"></div><section><div><div class="ant-skeleton ant-skeleton-active css-12jzuas"><div class="ant-skeleton-content"><h3 class="ant-skeleton-title" style="width:38%"></h3><ul class="ant-skeleton-paragraph"><li></li><li></li><li style="width:61%"></li></ul></div></div></div></section></article></div></div></div><div class="w-64 bg-white"><div><div class=""><div class="ant-collapse ant-collapse-icon-position-end question-menus-collapse css-12jzuas"><div class="ant-collapse-item ant-collapse-item-active"><div class="ant-collapse-header" aria-expanded="true" aria-disabled="false" role="button" tabindex="0"><div class="ant-collapse-expand-icon"><span role="img" aria-label="right" class="anticon anticon-right ant-collapse-arrow"><svg viewBox="64 64 896 896" focusable="false" style="-ms-transform:rotate(90deg);transform:rotate(90deg)" data-icon="right" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"></path></svg></span></div><span class="ant-collapse-header-text"><span class="text-base">目录</span></span><div class="ant-collapse-extra"><div class="-mr-2">收起</div></div></div><div class="ant-collapse-content ant-collapse-content-active"><div class="ant-collapse-content-box"><ul class="max-h-[620px] list-none space-y-3 overflow-y-auto text-slate-500 dark:text-slate-400"><li id="## 解析输入的URL" class="border-0 !border-l-2 border-solid border-transparent pr-[16px] text-base !border-sky-500"><a class="w-full overflow-hidden !text-[#515767] !text-sky-500" href="/toolbox-frontend/articles/74#%E8%A7%A3%E6%9E%90%E8%BE%93%E5%85%A5%E7%9A%84url"><div class="truncate" style="padding-left:16px">解析输入的URL</div></a></li><li id="## 检查 HSTS 列表" class="border-0 !border-l-2 border-solid border-transparent pr-[16px] text-base"><a class="w-full overflow-hidden !text-[#515767] !hover:text-slate-600 !dark:hover:text-slate-300" href="/toolbox-frontend/articles/74#%E6%A3%80%E6%9F%A5-hsts-%E5%88%97%E8%A1%A8"><div class="truncate" style="padding-left:16px">检查 HSTS 列表</div></a></li><li id="### 简介" class="border-0 !border-l-2 border-solid border-transparent pr-[16px] text-base"><a class="w-full overflow-hidden !text-[#515767] !hover:text-slate-600 !dark:hover:text-slate-300" href="/toolbox-frontend/articles/74#%E7%AE%80%E4%BB%8B"><div class="truncate" style="padding-left:32px">简介</div></a></li><li id="### 原理" class="border-0 !border-l-2 border-solid border-transparent pr-[16px] text-base"><a class="w-full overflow-hidden !text-[#515767] !hover:text-slate-600 !dark:hover:text-slate-300" href="/toolbox-frontend/articles/74#%E5%8E%9F%E7%90%86"><div class="truncate" style="padding-left:32px">原理</div></a></li><li id="### 注意" class="border-0 !border-l-2 border-solid border-transparent pr-[16px] text-base"><a class="w-full overflow-hidden !text-[#515767] !hover:text-slate-600 !dark:hover:text-slate-300" href="/toolbox-frontend/articles/74#%E6%B3%A8%E6%84%8F"><div class="truncate" style="padding-left:32px">注意</div></a></li><li id="### DNS 查询" class="border-0 !border-l-2 border-solid border-transparent pr-[16px] text-base"><a class="w-full overflow-hidden !text-[#515767] !hover:text-slate-600 !dark:hover:text-slate-300" href="/toolbox-frontend/articles/74#dns-%E6%9F%A5%E8%AF%A2"><div class="truncate" style="padding-left:32px">DNS 查询</div></a></li><li id="## TCP连接和TLS 握手" class="border-0 !border-l-2 border-solid border-transparent pr-[16px] text-base"><a class="w-full overflow-hidden !text-[#515767] !hover:text-slate-600 !dark:hover:text-slate-300" href="/toolbox-frontend/articles/74#tcp%E8%BF%9E%E6%8E%A5%E5%92%8Ctls-%E6%8F%A1%E6%89%8B"><div class="truncate" style="padding-left:16px">TCP连接和TLS 握手</div></a></li><li id="### 基于TSL的安全TCP传输实现" class="border-0 !border-l-2 border-solid border-transparent pr-[16px] text-base"><a class="w-full overflow-hidden !text-[#515767] !hover:text-slate-600 !dark:hover:text-slate-300" href="/toolbox-frontend/articles/74#%E5%9F%BA%E4%BA%8Etsl%E7%9A%84%E5%AE%89%E5%85%A8tcp%E4%BC%A0%E8%BE%93%E5%AE%9E%E7%8E%B0"><div class="truncate" style="padding-left:32px">基于TSL的安全TCP传输实现</div></a></li><li id="### HTTP请求" class="border-0 !border-l-2 border-solid border-transparent pr-[16px] text-base"><a class="w-full overflow-hidden !text-[#515767] !hover:text-slate-600 !dark:hover:text-slate-300" href="/toolbox-frontend/articles/74#http%E8%AF%B7%E6%B1%82"><div class="truncate" style="padding-left:32px">HTTP请求</div></a></li><li id="### HTTP 服务器请求处理" class="border-0 !border-l-2 border-solid border-transparent pr-[16px] text-base"><a class="w-full overflow-hidden !text-[#515767] !hover:text-slate-600 !dark:hover:text-slate-300" href="/toolbox-frontend/articles/74#http-%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86"><div class="truncate" style="padding-left:32px">HTTP 服务器请求处理</div></a></li><li id="## 浏览器渲染" class="border-0 !border-l-2 border-solid border-transparent pr-[16px] text-base"><a class="w-full overflow-hidden !text-[#515767] !hover:text-slate-600 !dark:hover:text-slate-300" href="/toolbox-frontend/articles/74#%E6%B5%8F%E8%A7%88%E5%99%A8%E6%B8%B2%E6%9F%93"><div class="truncate" style="padding-left:16px">浏览器渲染</div></a></li><li id="### 页面渲染" class="border-0 !border-l-2 border-solid border-transparent pr-[16px] text-base"><a class="w-full overflow-hidden !text-[#515767] !hover:text-slate-600 !dark:hover:text-slate-300" href="/toolbox-frontend/articles/74#%E9%A1%B5%E9%9D%A2%E6%B8%B2%E6%9F%93"><div class="truncate" style="padding-left:32px">页面渲染</div></a></li><li id="## HTML 解析" class="border-0 !border-l-2 border-solid border-transparent pr-[16px] text-base"><a class="w-full overflow-hidden !text-[#515767] !hover:text-slate-600 !dark:hover:text-slate-300" href="/toolbox-frontend/articles/74#html-%E8%A7%A3%E6%9E%90"><div class="truncate" style="padding-left:16px">HTML 解析</div></a></li><li id="### 解析算法" class="border-0 !border-l-2 border-solid border-transparent pr-[16px] text-base"><a class="w-full overflow-hidden !text-[#515767] !hover:text-slate-600 !dark:hover:text-slate-300" href="/toolbox-frontend/articles/74#%E8%A7%A3%E6%9E%90%E7%AE%97%E6%B3%95"><div class="truncate" style="padding-left:32px">解析算法</div></a></li><li id="### 解析结束之后" class="border-0 !border-l-2 border-solid border-transparent pr-[16px] text-base"><a class="w-full overflow-hidden !text-[#515767] !hover:text-slate-600 !dark:hover:text-slate-300" href="/toolbox-frontend/articles/74#%E8%A7%A3%E6%9E%90%E7%BB%93%E6%9D%9F%E4%B9%8B%E5%90%8E"><div class="truncate" style="padding-left:32px">解析结束之后</div></a></li><li id="### CSS 解析" class="border-0 !border-l-2 border-solid border-transparent pr-[16px] text-base"><a class="w-full overflow-hidden !text-[#515767] !hover:text-slate-600 !dark:hover:text-slate-300" href="/toolbox-frontend/articles/74#css-%E8%A7%A3%E6%9E%90"><div class="truncate" style="padding-left:32px">CSS 解析</div></a></li><li id="### GPU 渲染" class="border-0 !border-l-2 border-solid border-transparent pr-[16px] text-base"><a class="w-full overflow-hidden !text-[#515767] !hover:text-slate-600 !dark:hover:text-slate-300" href="/toolbox-frontend/articles/74#gpu-%E6%B8%B2%E6%9F%93"><div class="truncate" style="padding-left:32px">GPU 渲染</div></a></li><li id="### 后期渲染与用户引发的处理" class="border-0 !border-l-2 border-solid border-transparent pr-[16px] text-base"><a class="w-full overflow-hidden !text-[#515767] !hover:text-slate-600 !dark:hover:text-slate-300" href="/toolbox-frontend/articles/74#%E5%90%8E%E6%9C%9F%E6%B8%B2%E6%9F%93%E4%B8%8E%E7%94%A8%E6%88%B7%E5%BC%95%E5%8F%91%E7%9A%84%E5%A4%84%E7%90%86"><div class="truncate" style="padding-left:32px">后期渲染与用户引发的处理</div></a></li></ul></div></div></div></div></div></div></div></div></div><div style="position:fixed;z-index:9999;top:16px;left:16px;right:16px;bottom:16px;pointer-events:none"></div></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"article":{"url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/74","repository_url":"https://api.github.com/repos/hankliu62/hankliu62.github.com","labels_url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/74/labels{/name}","comments_url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/74/comments","events_url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/74/events","html_url":"https://github.com/hankliu62/hankliu62.github.com/issues/74","id":1802071278,"node_id":"I_kwDOBiJZIc5raWzu","number":74,"title":"浏览器打开网页全过程","user":{"login":"hankliu62","id":8088864,"node_id":"MDQ6VXNlcjgwODg4NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8088864?v=4","gravatar_id":"","url":"https://api.github.com/users/hankliu62","html_url":"https://github.com/hankliu62","followers_url":"https://api.github.com/users/hankliu62/followers","following_url":"https://api.github.com/users/hankliu62/following{/other_user}","gists_url":"https://api.github.com/users/hankliu62/gists{/gist_id}","starred_url":"https://api.github.com/users/hankliu62/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hankliu62/subscriptions","organizations_url":"https://api.github.com/users/hankliu62/orgs","repos_url":"https://api.github.com/users/hankliu62/repos","events_url":"https://api.github.com/users/hankliu62/events{/privacy}","received_events_url":"https://api.github.com/users/hankliu62/received_events","type":"User","site_admin":false},"labels":[{"id":688950687,"node_id":"MDU6TGFiZWw2ODg5NTA2ODc=","url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/labels/blog","name":"blog","color":"1677ff","default":false,"description":"博客文章"}],"state":"open","locked":false,"assignee":{"login":"hankliu62","id":8088864,"node_id":"MDQ6VXNlcjgwODg4NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8088864?v=4","gravatar_id":"","url":"https://api.github.com/users/hankliu62","html_url":"https://github.com/hankliu62","followers_url":"https://api.github.com/users/hankliu62/followers","following_url":"https://api.github.com/users/hankliu62/following{/other_user}","gists_url":"https://api.github.com/users/hankliu62/gists{/gist_id}","starred_url":"https://api.github.com/users/hankliu62/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hankliu62/subscriptions","organizations_url":"https://api.github.com/users/hankliu62/orgs","repos_url":"https://api.github.com/users/hankliu62/repos","events_url":"https://api.github.com/users/hankliu62/events{/privacy}","received_events_url":"https://api.github.com/users/hankliu62/received_events","type":"User","site_admin":false},"assignees":[{"login":"hankliu62","id":8088864,"node_id":"MDQ6VXNlcjgwODg4NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/8088864?v=4","gravatar_id":"","url":"https://api.github.com/users/hankliu62","html_url":"https://github.com/hankliu62","followers_url":"https://api.github.com/users/hankliu62/followers","following_url":"https://api.github.com/users/hankliu62/following{/other_user}","gists_url":"https://api.github.com/users/hankliu62/gists{/gist_id}","starred_url":"https://api.github.com/users/hankliu62/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hankliu62/subscriptions","organizations_url":"https://api.github.com/users/hankliu62/orgs","repos_url":"https://api.github.com/users/hankliu62/repos","events_url":"https://api.github.com/users/hankliu62/events{/privacy}","received_events_url":"https://api.github.com/users/hankliu62/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2023-07-13T03:07:43Z","updated_at":"2023-07-13T03:07:44Z","closed_at":null,"author_association":"OWNER","active_lock_reason":null,"body":"\r\n## 解析输入的URL\r\n\r\n![image](https://github.com/hankliu62/hankliu62.github.com/assets/8088864/15f9e1ec-9f3b-4db0-a3d2-769b453e3ddc)\r\n\r\n- 浏览器通过 URL 能够知道下面的信息：\r\n  - Protocol \"http\" 使用HTTP协议\r\n  - Domain \"www.server.com\" 对应服务器的域名\r\n  - Resource 请求资源的路径，\"/\" 表示请求的资源是主页(index)\r\n\r\n## 检查 HSTS 列表\r\n### 简介\r\nHSTS（HTTP Strict Transport Security），网站采用 HSTS 后，用户访问时无需手动在地址栏中输入HTTPS，浏览器会自动采用 HTTPS 访问网站地址，从而保证用户始终访问到网站的加密链接，保护数据传输安全，其作用就是强制客户端使用HTTPS访问页面的。\r\n\r\n### 原理\r\n1. 在服务器响应头中添加 Strict-Transport-Security , 并且可以设置 max-age\r\n2. 用户访问的时候，服务器种下这个头\r\n3. 下次如果使用 http 访问，只要 max-age 没有过期，客户端会进行内部跳转，会出现 307 Redirect Internel 状态码\r\n4. 变成 https 后，再访问资源服务器\r\n\r\n### 注意\r\n- 浏览器检查自带的“预加载 HSTS（HTTP严格传输安全）”列表，这个列表里包含了那些请求浏览器只使用HTTPS进行连接的网站\r\n- 如果网站在这个列表里，浏览器会使用 HTTPS 而不是 HTTP 协议，否则，最初的请求会使用HTTP协议发送，谷歌浏览器可以输入 chrome://net-internals/#hsts 来访问浏览器本地的HSTS域名列表\r\n- 注意，一个网站哪怕不在 HSTS 列表里，也可以要求浏览器对自己使用 HSTS 政策进行访问。浏览器向网站发出第一个 HTTP 请求之后，网站会返回浏览器一个响应，请求浏览器只使用 HTTPS 发送请求。然而，就是这第一个 HTTP 请求，却可能会使用户受到降级攻击的威胁，这也是为什么现代浏览器都预置了 HSTS 列表。\r\n\r\n### DNS 查询\r\n\r\n- 浏览器检查域名是否在缓存当中（要查看 Chrome 当中的缓存， 打开 chrome://net-internals/#dns）。\r\n- 如果缓存中没有，就去调用 gethostbyname 库函数（操作系统不同函数也不同）进行查询。\r\n- gethostbyname 函数在试图进行DNS解析之前首先检查域名是否在本地 Hosts 里，Hosts 的位置 [不同的操作系统有所不同]\r\n- 如果 gethostbyname 没有这个域名的缓存记录，也没有在 hosts 里找到，它将会向 DNS 服务器发送一条 DNS 查询请求。DNS 服务器是由网络通信栈提供的，通常是本地路由器或者 ISP 的缓存 DNS 服务器。\r\n- 查询本地 DNS 服务器，操作系统将域名发送至本地 DNS 服务器，本地域名服务器查询自己的 DNS 缓存，查找成功则返回结果\r\n- 若本地域名服务器的 DNS 缓存没有命中，则本地域名服务器向上级域名服务器进行查询，通过以下方式进行迭代查询\r\n  - 首先本地域名服务器向根域名服务器发起请求，根域名服务器是最高层次的，它并不会直接指明这个域名对应的 IP 地址，而是返回顶级域名服务器的地址，也就是说给本地域名服务器指明一条道路，让他去这里寻找答案\r\n  - 本地域名服务器拿到这个顶级域名服务器的地址后，就向其发起请求，获取权限域名服务器的地址\r\n  - 本地域名服务器根据权限域名服务器的地址向其发起请求，最终得到该域名对应的 IP 地址\r\n- 本地域名服务器将得到的 IP 地址返回给操作系统，同时自己将 IP 地址缓存起来\r\n- 操作系统将 IP 地址返回给浏览器，同时自己也将 IP 地址缓存起来\r\n- 至此，浏览器就得到了域名对应的 IP 地址，并将 IP 地址缓存起来\r\n\r\n![image](https://github.com/hankliu62/hankliu62.github.com/assets/8088864/11c4e73a-4de1-47e5-85fe-83ffb62d55f0)\r\n\r\n\r\n## TCP连接和TLS 握手\r\n\r\n三次握手\r\n\r\n![image](https://github.com/hankliu62/hankliu62.github.com/assets/8088864/7664cf4c-05c7-49de-bc52-69a23d841a39)\r\n\r\n### 基于TSL的安全TCP传输实现\r\n- 客户端发送一个 ClientHello 消息到服务器端，消息中同时包含了它的 Transport Layer Security (TLS) 版本，可用的加密算法和压缩算法。\r\n- 服务器端向客户端返回一个 ServerHello 消息，消息中包含了服务器端的TLS版本，服务器所选择的加密和压缩算法，以及数字证书认证机构（Certificate Authority，缩写 CA）签发的服务器公开证书，证书中包含了公钥。客户端会使用这个公钥加密接下来的握手过程，直到协商生成一个新的对称密钥\r\n- 客户端根据自己的信任CA列表，验证服务器端的证书是否可信。如果认为可信，客户端会生成一串伪随机数，使用服务器的公钥加密它。这串随机数会被用于生成新的对称密钥\r\n- 服务器端使用自己的私钥解密上面提到的随机数，然后使用这串随机数生成自己的对称主密钥\r\n- 客户端发送一个 Finished 消息给服务器端，使用对称密钥加密这次通讯的一个散列值\r\n- 服务器端生成自己的 hash 值，然后解密客户端发送来的信息，检查这两个值是否对应。如果对应，就向客户端发送一个 Finished 消息，也使用协商好的对称密钥加密\r\n- 从现在开始，接下来整个 TLS 会话都使用对称秘钥进行加密，传输应用层（HTTP）内容\r\n\r\n### HTTP请求\r\n向服务器发送这样的一个请求\r\n```\r\nGET / HTTP/1.1\r\nHost: muselink.cc\r\nConnection: keep-alive\r\nCache-Control: max-age=0\r\naccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\r\naccept-encoding: gzip, deflate, br\r\naccept-language: zh-CN,zh;q=0.9\r\ncache-control: no-cache\r\ncookie: __snaker__id=RHT7U0jq1AzBotQZ; _9755xjdesxxd_=32; gdxidpyhxdE=DZ%2BCWzKiwnlgcadl%2Fas2YP%5Cb%5CAQpf2pkgStb1XfvnVs1EyUhLVOxd%5C8ilDn35wQw4tAyz%5CsqEHStrJXmTVyw83Ul00SbbLXG9zTKf%2BdTW3rGckyaitPKJO6fnlsZ7JRANw94GQAt%5CGLtaDM58qedwv7%2FnywARt%2FKbw6%2BS5DbQGWXwoPw%3A1667534542283\r\npragma: no-cache\r\nuser-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.0.0 Safari/537.36\r\nx-asm-prefer-tag: version-env-26\r\n```\r\n\r\n“其他头部”包含了一系列的由冒号分割开的键值对，它们的格式符合HTTP协议标准，它们之间由一个换行符分割开来。（假设浏览器使用 `HTTP/1.1` 协议，不然的话头部可能不包含 **Host** 字段，同时 **GET** 请求中的版本号会变成 `HTTP/1.0` 或者 `HTTP/0.9`。）\r\n\r\n`HTTP/1.1` 定义了“关闭连接”的选项 \"close\"，发送者使用这个选项指示这次连接在响应结束之后会断开。例如：\r\n`Connection:close`\r\n\r\n不支持持久连接的 `HTTP/1.1` 应用必须在每条消息中都包含 \"close\" 选项。\r\n\r\n在发送完这些请求和头部之后，浏览器发送一个换行符，表示要发送的内容已经结束了。\r\n\r\n**服务器端返回一个响应码，指示这次请求的状态，响应的形式是这样的**\r\n\r\n```\r\nHTTP/1.1 200 OK\r\nDate: Tue, 08 Jul 2014 05:28:43 GMT\r\nServer: Apache/2\r\nLast-Modified: Wed, 01 Sep 2004 13:24:52 GMT\r\nETag: \"40d7-3e3073913b100\"\r\nAccept-Ranges: bytes\r\nContent-Length: 16599\r\nCache-Control: max-age=21600\r\nExpires: Tue, 08 Jul 2014 11:28:43 GMT\r\nContent-Type: text/html; charset=iso-8859-1\r\n\r\nxxxxx\r\n```\r\n\r\n然后是一个换行，接下来有效载荷(payload)，也就是 `muselink.cc` 的HTML内容。服务器下面可能会关闭连接，如果客户端请求保持连接的话，服务器端会保持连接打开，以供之后的请求重用。\r\n\r\n**如果浏览器发送的HTTP头部包含了足够多的信息（例如包含了 Etag 头部），以至于服务器可以判断出，浏览器缓存的文件版本自从上次获取之后没有再更改过，服务器可能会返回这样的响应**\r\n\r\n```\r\n304 Not Modified [响应头部]\r\n```\r\n这个响应没有有效载荷，浏览器会从自己的缓存中取出想要的内容。\r\n\r\n在解析完 HTML 之后，浏览器和客户端会重复上面的过程，直到HTML页面引入的所有资源（图片，CSS，favicon.ico等等）全部都获取完毕，区别只是头部的 `GET / HTTP/1.1` 会变成 `GET /$(相对muselink.cc的URL) HTTP/1.1` 。\r\n\r\n如果HTML引入了 `muselink.cc` 域名之外的资源，浏览器会回到上面解析域名那一步，按照步骤往下一步一步执行，请求中的 **Host** 头部会变成另外的域名。\r\n\r\n### HTTP 服务器请求处理\r\n\r\nHTTPD(HTTP Daemon)在服务器端处理请求/响应。最常见的 HTTPD 有 Linux 上常用的 nginx 和 Apache，以及 Windows 上的 IIS。\r\n- HTTPD 接收请求\r\n- 服务器把请求拆分为以下几个参数：\r\n- HTTP 请求方法(GET, POST, HEAD, PUT, DELETE, CONNECT, OPTIONS, 或者 TRACE)。直接在地址栏中输入 URL 这种情况下，使用的是 GET 方法\r\n- 域名：muselink.cc\r\n- 请求路径/页面：/ (我们没有请求muselink.cc下的指定的页面，因此 / 是默认的路径)\r\n- 服务器验证其上已经配置了muselink.cc 的虚拟主机\r\n- 服务器验证 muselink.cc 接受 GET 方法\r\n- 服务器验证该用户可以使用 GET 方法(根据 IP 地址，身份信息等)\r\n- 服务器根据请求信息获取相应的响应内容，这种情况下由于访问路径是 \"/\" ,会访问首页文件（你可以重写这个规则，但是这个是最常用的）\r\n\r\n[一台服务器上搭建多个Web项目](https://help.aliyun.com/document_detail/171730.htm?spm=a2c4g.11186623.0.0.108022d7NNgpOT#task-2539916)\r\n\r\n## 浏览器渲染\r\n浏览器的功能是从服务器上取回你想要的资源，然后展示在浏览器窗口当中。资源通常是 HTML 文件，也可能是 PDF，图片，或者其他类型的内容。资源的位置通过用户提供的 URI(Uniform Resource Identifier) 来确定。\r\n\r\n组成浏览器的组件有：\r\n\r\n- **用户界面** 用户界面包含了地址栏，前进后退按钮，书签菜单等等，除了请求页面之外所有你看到的内容都是用户界面的一部分\r\n- **浏览器引擎** 浏览器引擎负责让 UI 和渲染引擎协调工作\r\n- **渲染引擎** 渲染引擎负责展示请求内容。如果请求的内容是 HTML，渲染引擎会解析 HTML 和 CSS，然后将内容展示在屏幕上\r\n- **网络组件** 网络组件负责网络调用，例如 HTTP 请求等，使用一个平台无关接口，下层是针对不同平台的具体实现\r\n- **UI后端 UI** 后端用于绘制基本 UI 组件，例如下拉列表框和窗口。UI 后端暴露一个统一的平台无关的接口，下层使用操作系统的 UI 方法实现\r\n- **Javascript 引擎** Javascript 引擎用于解析和执行 Javascript 代码\r\n- **数据存储** 数据存储组件是一个持久层。浏览器可能需要在本地存储各种各样的数据，例如 Cookie 等。浏览器也需要支持诸如 localStorage，IndexedDB，WebSQL 和 FileSystem 之类的存储机制\r\n\r\n### 页面渲染\r\n\r\n当服务器提供了资源之后（HTML，CSS，JS，图片等），浏览器会执行下面的操作：\r\n\r\n1. 解析 —— HTML，CSS，JS\r\n2. 渲染 —— 构建 DOM 树 → 渲染 → 布局 → 绘制\r\n\r\n具体表现：\r\n- 通过遍历DOM节点树创建一个“渲染树”，并计算每个节点的各个CSS样式值\r\n- 通过累加子节点的宽度，该节点的水平内边距(padding)、边框(border)和外边距(margin)，自底向上的计算\"Frame 树\"中每个节点的首选(preferred)宽度\r\n- 通过自顶向下的给每个节点的子节点分配可行宽度，计算每个节点的实际宽度\r\n- 通过应用文字折行、累加子节点的高度和此节点的内边距(padding)、边框(border)和外边距(margin)，自底向上的计算每个节点的高度\r\n- 使用上面的计算结果构建每个节点的坐标\r\n- 当存在元素使用 floated，位置有 absolutely 或 relatively 属性的时候，会有更多复杂的计算，详见http://dev.w3.org/csswg/css2/ 和 http://www.w3.org/Style/CSS/current-work\r\n- 创建layer(层)来表示页面中的哪些部分可以成组的被绘制，而不用被重新栅格化处理。每个帧对象都被分配给一个层\r\n- 页面上的每个层都被分配了纹理(?)\r\n- 每个层的帧对象都会被遍历，计算机执行绘图命令绘制各个层，此过程可能由CPU执行栅格化处理，或者直接通过D2D/SkiaGL在GPU上绘制\r\n- 上面所有步骤都可能利用到最近一次页面渲染时计算出来的各个值，这样可以减少不少计算量\r\n- 计算出各个层的最终位置，一组命令由 Direct3D/OpenGL发出，GPU命令缓冲区清空，命令传至GPU并异步渲染，帧被送到Window Server。\r\n\r\n## HTML 解析\r\n\r\n浏览器渲染引擎从网络层取得请求的文档，一般情况下文档会分成8kB大小的分块传输。\r\n\r\nHTML 解析器的主要工作是对 HTML 文档进行解析，生成解析树。\r\n\r\n解析树是以 DOM 元素以及属性为节点的树。DOM是文档对象模型(Document Object Model)的缩写，它是 HTML 文档的对象表示，同时也是 HTML 元素面向外部(如Javascript)的接口。树的根部是\"Document\"对象。整个 DOM 和 HTML 文档几乎是一对一的关系。\r\n\r\n### 解析算法\r\n\r\nHTML不能使用常见的自顶向下或自底向上方法来进行分析。主要原因有以下几点:\r\n- 语言本身的“宽容”特性\r\n- HTML 本身可能是残缺的，对于常见的残缺，浏览器需要有传统的容错机制来支持它们\r\n- 解析过程需要反复。对于其他语言来说，源码不会在解析过程中发生变化，但是对于 HTML 来说，动态代码，例如脚本元素中包含的 document.write() 方法会在源码中添加内容，也就是说，解析过程实际上会改变输入的内容\r\n\r\n由于不能使用常用的解析技术，浏览器创造了专门用于解析 HTML 的解析器。解析算法在 HTML5 标准规范中有详细介绍，算法主要包含了两个阶段：标记化（tokenization）和树的构建。\r\n\r\n### 解析结束之后\r\n\r\n浏览器开始加载网页的外部资源（CSS，图像，Javascript 文件等）。\r\n\r\n此时浏览器把文档标记为可交互的（interactive），浏览器开始解析处于“推迟（deferred）”模式的脚本，也就是那些需要在文档解析完毕之后再执行的脚本。之后文档的状态会变为“完成（complete）”，浏览器会触发“加载（load）”事件。\r\n\r\n注意解析 HTML 网页时永远不会出现“无效语法（Invalid Syntax）”错误，浏览器会修复所有错误内容，然后继续解析。\r\n\r\n### CSS 解析\r\n- 根据 CSS词法和句法`分析CSS文件和 \u003cstyle\u003e 标签包含的内容以及 \u003cstyle\u003e  `属性的值\r\n- 每个CSS文件都被解析成一个样式表对象（`StyleSheet object`），这个对象里包含了带有选择器的CSS规则，和对应CSS语法的对象\r\n\r\n### GPU 渲染\r\n- 在渲染过程中，图形处理层可能使用通用用途的 **CPU**，也可能使用图形处理器 **GPU**\r\n- 当使用 GPU 用于图形渲染时，图形驱动软件会把任务分成多个部分，这样可以充分利用 **GPU** 强大的并行计算能力，用于在渲染过程中进行大量的浮点计算。\r\n\r\n### 后期渲染与用户引发的处理\r\n\r\n渲染结束后，浏览器根据某些时间机制运行JavaScript代码(比如Google Doodle动画)或与用户交互(在搜索栏输入关键字获得搜索建议)。这些脚本可以触发网络请求，也可能改变网页的内容和布局，产生又一轮渲染与绘制。","closed_by":null,"reactions":{"url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/74/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/hankliu62/hankliu62.github.com/issues/74/timeline","performed_via_github_app":null,"state_reason":null},"menus":["## 解析输入的URL","## 检查 HSTS 列表","### 简介","### 原理","### 注意","### DNS 查询","## TCP连接和TLS 握手","### 基于TSL的安全TCP传输实现","### HTTP请求","### HTTP 服务器请求处理","## 浏览器渲染","### 页面渲染","## HTML 解析","### 解析算法","### 解析结束之后","### CSS 解析","### GPU 渲染","### 后期渲染与用户引发的处理"]},"__N_SSG":true},"page":"/articles/[id]","query":{"id":"74"},"buildId":"rQDidgBY5jj2zjb_Ap18Y","assetPrefix":"/toolbox-frontend","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>